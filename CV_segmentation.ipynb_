{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"8I9O69QIbAK0"},"outputs":[],"source":["import tensorflow as tf\n","import os, shutil\n","import numpy as np"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":17930,"status":"ok","timestamp":1649918073225,"user":{"displayName":"Даниил Маненок","userId":"11391168364756720378"},"user_tz":-300},"id":"PdCdG6AibEy-","outputId":"afd495ad-0194-44b7-95a5-6951c69366a9"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"95UiOSDKbSjN"},"outputs":[],"source":["original_dataset_dir = '/content/drive/MyDrive/Colab Notebooks/Магистратура/dataset'\n","\n","base_dir = '/content/drive/MyDrive/Colab Notebooks/Магистратура/dataset/Датасет'\n","os.mkdir(base_dir)\n","\n","train_dir = os.path.join(base_dir, 'train')\n","os.mkdir(train_dir)\n","validation_dir = os.path.join(base_dir, 'validation')\n","os.mkdir(validation_dir)\n","test_dir = os.path.join(base_dir, 'test')\n","os.mkdir(test_dir)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_s7nEoiHoIqp"},"outputs":[],"source":["for no in [str(x) for x in np.arange(15)]:\n","  os.mkdir(os.path.join(train_dir, no))\n","  os.mkdir(os.path.join(validation_dir, no))\n","  os.mkdir(os.path.join(test_dir, no))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9sgHzoUDz7yQ","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649918332373,"user_tz":-300,"elapsed":362,"user":{"displayName":"Даниил Маненок","userId":"11391168364756720378"}},"outputId":"b4daea0d-499d-4051-91c0-23c709403c93"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["[600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600]"]},"metadata":{},"execution_count":6}],"source":["list = []\n","\n","for no in [str(x) for x in np.arange(15)]:\n","  os.path.join(original_dataset_dir, no)\n","  len = np.asarray(os.listdir(os.path.join(original_dataset_dir, no))).shape[0]\n","  list.append(len)\n","\n","list"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"MLaGEFBtw8sq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649918572894,"user_tz":-300,"elapsed":234725,"user":{"displayName":"Даниил Маненок","userId":"11391168364756720378"}},"outputId":"7e59ee9e-f6e4-43b7-faea-e11ccbe0cba6"},"outputs":[{"output_type":"stream","name":"stdout","text":["CPU times: user 6.38 s, sys: 11.9 s, total: 18.3 s\n","Wall time: 3min 54s\n"]}],"source":["%%time\n","for no in [str(x) for x in np.arange(15)]:\n","  dir = os.path.join(original_dataset_dir, no)\n","  fnames = ['{}'.format(i) for i in os.listdir(dir)]\n","  for fname in fnames[:400]:\n","    src = os.path.join(os.path.join(dir, fname))\n","    dst = os.path.join(os.path.join(train_dir, no), fname)\n","    shutil.copyfile(src, dst)\n","  for fname in fnames[400:500]:\n","    src = os.path.join(os.path.join(dir, fname))\n","    dst = os.path.join(os.path.join(validation_dir, no), fname)\n","    shutil.copyfile(src, dst)\n","  for fname in fnames[500:]:\n","    src = os.path.join(os.path.join(dir, fname))\n","    dst = os.path.join(os.path.join(test_dir, no), fname)\n","    shutil.copyfile(src, dst)"]},{"cell_type":"code","source":["# EfficientNetB0/224*224/расширение данных/10 эпох"],"metadata":{"id":"cS2w4T5beP0N"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["conv_base = tf.keras.applications.EfficientNetB0(\n","    include_top=False,\n","    weights=\"imagenet\",\n","    input_shape=(224, 224, 3))"],"metadata":{"id":"IYMt9p3JriKu"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["conv_base.summary()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"gdo4PyuwriNm","executionInfo":{"status":"ok","timestamp":1649919157409,"user_tz":-300,"elapsed":2929,"user":{"displayName":"Даниил Маненок","userId":"11391168364756720378"}},"outputId":"94962133-2864-46a2-b815-d05265fc9aff"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Model: \"efficientnetb0\"\n","__________________________________________________________________________________________________\n"," Layer (type)                   Output Shape         Param #     Connected to                     \n","==================================================================================================\n"," input_2 (InputLayer)           [(None, 224, 224, 3  0           []                               \n","                                )]                                                                \n","                                                                                                  \n"," rescaling_1 (Rescaling)        (None, 224, 224, 3)  0           ['input_2[0][0]']                \n","                                                                                                  \n"," normalization_1 (Normalization  (None, 224, 224, 3)  7          ['rescaling_1[0][0]']            \n"," )                                                                                                \n","                                                                                                  \n"," stem_conv_pad (ZeroPadding2D)  (None, 225, 225, 3)  0           ['normalization_1[0][0]']        \n","                                                                                                  \n"," stem_conv (Conv2D)             (None, 112, 112, 32  864         ['stem_conv_pad[0][0]']          \n","                                )                                                                 \n","                                                                                                  \n"," stem_bn (BatchNormalization)   (None, 112, 112, 32  128         ['stem_conv[0][0]']              \n","                                )                                                                 \n","                                                                                                  \n"," stem_activation (Activation)   (None, 112, 112, 32  0           ['stem_bn[0][0]']                \n","                                )                                                                 \n","                                                                                                  \n"," block1a_dwconv (DepthwiseConv2  (None, 112, 112, 32  288        ['stem_activation[0][0]']        \n"," D)                             )                                                                 \n","                                                                                                  \n"," block1a_bn (BatchNormalization  (None, 112, 112, 32  128        ['block1a_dwconv[0][0]']         \n"," )                              )                                                                 \n","                                                                                                  \n"," block1a_activation (Activation  (None, 112, 112, 32  0          ['block1a_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block1a_se_squeeze (GlobalAver  (None, 32)          0           ['block1a_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block1a_se_reshape (Reshape)   (None, 1, 1, 32)     0           ['block1a_se_squeeze[0][0]']     \n","                                                                                                  \n"," block1a_se_reduce (Conv2D)     (None, 1, 1, 8)      264         ['block1a_se_reshape[0][0]']     \n","                                                                                                  \n"," block1a_se_expand (Conv2D)     (None, 1, 1, 32)     288         ['block1a_se_reduce[0][0]']      \n","                                                                                                  \n"," block1a_se_excite (Multiply)   (None, 112, 112, 32  0           ['block1a_activation[0][0]',     \n","                                )                                 'block1a_se_expand[0][0]']      \n","                                                                                                  \n"," block1a_project_conv (Conv2D)  (None, 112, 112, 16  512         ['block1a_se_excite[0][0]']      \n","                                )                                                                 \n","                                                                                                  \n"," block1a_project_bn (BatchNorma  (None, 112, 112, 16  64         ['block1a_project_conv[0][0]']   \n"," lization)                      )                                                                 \n","                                                                                                  \n"," block2a_expand_conv (Conv2D)   (None, 112, 112, 96  1536        ['block1a_project_bn[0][0]']     \n","                                )                                                                 \n","                                                                                                  \n"," block2a_expand_bn (BatchNormal  (None, 112, 112, 96  384        ['block2a_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block2a_expand_activation (Act  (None, 112, 112, 96  0          ['block2a_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block2a_dwconv_pad (ZeroPaddin  (None, 113, 113, 96  0          ['block2a_expand_activation[0][0]\n"," g2D)                           )                                ']                               \n","                                                                                                  \n"," block2a_dwconv (DepthwiseConv2  (None, 56, 56, 96)  864         ['block2a_dwconv_pad[0][0]']     \n"," D)                                                                                               \n","                                                                                                  \n"," block2a_bn (BatchNormalization  (None, 56, 56, 96)  384         ['block2a_dwconv[0][0]']         \n"," )                                                                                                \n","                                                                                                  \n"," block2a_activation (Activation  (None, 56, 56, 96)  0           ['block2a_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block2a_se_squeeze (GlobalAver  (None, 96)          0           ['block2a_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block2a_se_reshape (Reshape)   (None, 1, 1, 96)     0           ['block2a_se_squeeze[0][0]']     \n","                                                                                                  \n"," block2a_se_reduce (Conv2D)     (None, 1, 1, 4)      388         ['block2a_se_reshape[0][0]']     \n","                                                                                                  \n"," block2a_se_expand (Conv2D)     (None, 1, 1, 96)     480         ['block2a_se_reduce[0][0]']      \n","                                                                                                  \n"," block2a_se_excite (Multiply)   (None, 56, 56, 96)   0           ['block2a_activation[0][0]',     \n","                                                                  'block2a_se_expand[0][0]']      \n","                                                                                                  \n"," block2a_project_conv (Conv2D)  (None, 56, 56, 24)   2304        ['block2a_se_excite[0][0]']      \n","                                                                                                  \n"," block2a_project_bn (BatchNorma  (None, 56, 56, 24)  96          ['block2a_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block2b_expand_conv (Conv2D)   (None, 56, 56, 144)  3456        ['block2a_project_bn[0][0]']     \n","                                                                                                  \n"," block2b_expand_bn (BatchNormal  (None, 56, 56, 144)  576        ['block2b_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block2b_expand_activation (Act  (None, 56, 56, 144)  0          ['block2b_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block2b_dwconv (DepthwiseConv2  (None, 56, 56, 144)  1296       ['block2b_expand_activation[0][0]\n"," D)                                                              ']                               \n","                                                                                                  \n"," block2b_bn (BatchNormalization  (None, 56, 56, 144)  576        ['block2b_dwconv[0][0]']         \n"," )                                                                                                \n","                                                                                                  \n"," block2b_activation (Activation  (None, 56, 56, 144)  0          ['block2b_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block2b_se_squeeze (GlobalAver  (None, 144)         0           ['block2b_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block2b_se_reshape (Reshape)   (None, 1, 1, 144)    0           ['block2b_se_squeeze[0][0]']     \n","                                                                                                  \n"," block2b_se_reduce (Conv2D)     (None, 1, 1, 6)      870         ['block2b_se_reshape[0][0]']     \n","                                                                                                  \n"," block2b_se_expand (Conv2D)     (None, 1, 1, 144)    1008        ['block2b_se_reduce[0][0]']      \n","                                                                                                  \n"," block2b_se_excite (Multiply)   (None, 56, 56, 144)  0           ['block2b_activation[0][0]',     \n","                                                                  'block2b_se_expand[0][0]']      \n","                                                                                                  \n"," block2b_project_conv (Conv2D)  (None, 56, 56, 24)   3456        ['block2b_se_excite[0][0]']      \n","                                                                                                  \n"," block2b_project_bn (BatchNorma  (None, 56, 56, 24)  96          ['block2b_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block2b_drop (Dropout)         (None, 56, 56, 24)   0           ['block2b_project_bn[0][0]']     \n","                                                                                                  \n"," block2b_add (Add)              (None, 56, 56, 24)   0           ['block2b_drop[0][0]',           \n","                                                                  'block2a_project_bn[0][0]']     \n","                                                                                                  \n"," block3a_expand_conv (Conv2D)   (None, 56, 56, 144)  3456        ['block2b_add[0][0]']            \n","                                                                                                  \n"," block3a_expand_bn (BatchNormal  (None, 56, 56, 144)  576        ['block3a_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block3a_expand_activation (Act  (None, 56, 56, 144)  0          ['block3a_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block3a_dwconv_pad (ZeroPaddin  (None, 59, 59, 144)  0          ['block3a_expand_activation[0][0]\n"," g2D)                                                            ']                               \n","                                                                                                  \n"," block3a_dwconv (DepthwiseConv2  (None, 28, 28, 144)  3600       ['block3a_dwconv_pad[0][0]']     \n"," D)                                                                                               \n","                                                                                                  \n"," block3a_bn (BatchNormalization  (None, 28, 28, 144)  576        ['block3a_dwconv[0][0]']         \n"," )                                                                                                \n","                                                                                                  \n"," block3a_activation (Activation  (None, 28, 28, 144)  0          ['block3a_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block3a_se_squeeze (GlobalAver  (None, 144)         0           ['block3a_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block3a_se_reshape (Reshape)   (None, 1, 1, 144)    0           ['block3a_se_squeeze[0][0]']     \n","                                                                                                  \n"," block3a_se_reduce (Conv2D)     (None, 1, 1, 6)      870         ['block3a_se_reshape[0][0]']     \n","                                                                                                  \n"," block3a_se_expand (Conv2D)     (None, 1, 1, 144)    1008        ['block3a_se_reduce[0][0]']      \n","                                                                                                  \n"," block3a_se_excite (Multiply)   (None, 28, 28, 144)  0           ['block3a_activation[0][0]',     \n","                                                                  'block3a_se_expand[0][0]']      \n","                                                                                                  \n"," block3a_project_conv (Conv2D)  (None, 28, 28, 40)   5760        ['block3a_se_excite[0][0]']      \n","                                                                                                  \n"," block3a_project_bn (BatchNorma  (None, 28, 28, 40)  160         ['block3a_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block3b_expand_conv (Conv2D)   (None, 28, 28, 240)  9600        ['block3a_project_bn[0][0]']     \n","                                                                                                  \n"," block3b_expand_bn (BatchNormal  (None, 28, 28, 240)  960        ['block3b_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block3b_expand_activation (Act  (None, 28, 28, 240)  0          ['block3b_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block3b_dwconv (DepthwiseConv2  (None, 28, 28, 240)  6000       ['block3b_expand_activation[0][0]\n"," D)                                                              ']                               \n","                                                                                                  \n"," block3b_bn (BatchNormalization  (None, 28, 28, 240)  960        ['block3b_dwconv[0][0]']         \n"," )                                                                                                \n","                                                                                                  \n"," block3b_activation (Activation  (None, 28, 28, 240)  0          ['block3b_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block3b_se_squeeze (GlobalAver  (None, 240)         0           ['block3b_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block3b_se_reshape (Reshape)   (None, 1, 1, 240)    0           ['block3b_se_squeeze[0][0]']     \n","                                                                                                  \n"," block3b_se_reduce (Conv2D)     (None, 1, 1, 10)     2410        ['block3b_se_reshape[0][0]']     \n","                                                                                                  \n"," block3b_se_expand (Conv2D)     (None, 1, 1, 240)    2640        ['block3b_se_reduce[0][0]']      \n","                                                                                                  \n"," block3b_se_excite (Multiply)   (None, 28, 28, 240)  0           ['block3b_activation[0][0]',     \n","                                                                  'block3b_se_expand[0][0]']      \n","                                                                                                  \n"," block3b_project_conv (Conv2D)  (None, 28, 28, 40)   9600        ['block3b_se_excite[0][0]']      \n","                                                                                                  \n"," block3b_project_bn (BatchNorma  (None, 28, 28, 40)  160         ['block3b_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block3b_drop (Dropout)         (None, 28, 28, 40)   0           ['block3b_project_bn[0][0]']     \n","                                                                                                  \n"," block3b_add (Add)              (None, 28, 28, 40)   0           ['block3b_drop[0][0]',           \n","                                                                  'block3a_project_bn[0][0]']     \n","                                                                                                  \n"," block4a_expand_conv (Conv2D)   (None, 28, 28, 240)  9600        ['block3b_add[0][0]']            \n","                                                                                                  \n"," block4a_expand_bn (BatchNormal  (None, 28, 28, 240)  960        ['block4a_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block4a_expand_activation (Act  (None, 28, 28, 240)  0          ['block4a_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block4a_dwconv_pad (ZeroPaddin  (None, 29, 29, 240)  0          ['block4a_expand_activation[0][0]\n"," g2D)                                                            ']                               \n","                                                                                                  \n"," block4a_dwconv (DepthwiseConv2  (None, 14, 14, 240)  2160       ['block4a_dwconv_pad[0][0]']     \n"," D)                                                                                               \n","                                                                                                  \n"," block4a_bn (BatchNormalization  (None, 14, 14, 240)  960        ['block4a_dwconv[0][0]']         \n"," )                                                                                                \n","                                                                                                  \n"," block4a_activation (Activation  (None, 14, 14, 240)  0          ['block4a_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block4a_se_squeeze (GlobalAver  (None, 240)         0           ['block4a_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block4a_se_reshape (Reshape)   (None, 1, 1, 240)    0           ['block4a_se_squeeze[0][0]']     \n","                                                                                                  \n"," block4a_se_reduce (Conv2D)     (None, 1, 1, 10)     2410        ['block4a_se_reshape[0][0]']     \n","                                                                                                  \n"," block4a_se_expand (Conv2D)     (None, 1, 1, 240)    2640        ['block4a_se_reduce[0][0]']      \n","                                                                                                  \n"," block4a_se_excite (Multiply)   (None, 14, 14, 240)  0           ['block4a_activation[0][0]',     \n","                                                                  'block4a_se_expand[0][0]']      \n","                                                                                                  \n"," block4a_project_conv (Conv2D)  (None, 14, 14, 80)   19200       ['block4a_se_excite[0][0]']      \n","                                                                                                  \n"," block4a_project_bn (BatchNorma  (None, 14, 14, 80)  320         ['block4a_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block4b_expand_conv (Conv2D)   (None, 14, 14, 480)  38400       ['block4a_project_bn[0][0]']     \n","                                                                                                  \n"," block4b_expand_bn (BatchNormal  (None, 14, 14, 480)  1920       ['block4b_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block4b_expand_activation (Act  (None, 14, 14, 480)  0          ['block4b_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block4b_dwconv (DepthwiseConv2  (None, 14, 14, 480)  4320       ['block4b_expand_activation[0][0]\n"," D)                                                              ']                               \n","                                                                                                  \n"," block4b_bn (BatchNormalization  (None, 14, 14, 480)  1920       ['block4b_dwconv[0][0]']         \n"," )                                                                                                \n","                                                                                                  \n"," block4b_activation (Activation  (None, 14, 14, 480)  0          ['block4b_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block4b_se_squeeze (GlobalAver  (None, 480)         0           ['block4b_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block4b_se_reshape (Reshape)   (None, 1, 1, 480)    0           ['block4b_se_squeeze[0][0]']     \n","                                                                                                  \n"," block4b_se_reduce (Conv2D)     (None, 1, 1, 20)     9620        ['block4b_se_reshape[0][0]']     \n","                                                                                                  \n"," block4b_se_expand (Conv2D)     (None, 1, 1, 480)    10080       ['block4b_se_reduce[0][0]']      \n","                                                                                                  \n"," block4b_se_excite (Multiply)   (None, 14, 14, 480)  0           ['block4b_activation[0][0]',     \n","                                                                  'block4b_se_expand[0][0]']      \n","                                                                                                  \n"," block4b_project_conv (Conv2D)  (None, 14, 14, 80)   38400       ['block4b_se_excite[0][0]']      \n","                                                                                                  \n"," block4b_project_bn (BatchNorma  (None, 14, 14, 80)  320         ['block4b_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block4b_drop (Dropout)         (None, 14, 14, 80)   0           ['block4b_project_bn[0][0]']     \n","                                                                                                  \n"," block4b_add (Add)              (None, 14, 14, 80)   0           ['block4b_drop[0][0]',           \n","                                                                  'block4a_project_bn[0][0]']     \n","                                                                                                  \n"," block4c_expand_conv (Conv2D)   (None, 14, 14, 480)  38400       ['block4b_add[0][0]']            \n","                                                                                                  \n"," block4c_expand_bn (BatchNormal  (None, 14, 14, 480)  1920       ['block4c_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block4c_expand_activation (Act  (None, 14, 14, 480)  0          ['block4c_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block4c_dwconv (DepthwiseConv2  (None, 14, 14, 480)  4320       ['block4c_expand_activation[0][0]\n"," D)                                                              ']                               \n","                                                                                                  \n"," block4c_bn (BatchNormalization  (None, 14, 14, 480)  1920       ['block4c_dwconv[0][0]']         \n"," )                                                                                                \n","                                                                                                  \n"," block4c_activation (Activation  (None, 14, 14, 480)  0          ['block4c_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block4c_se_squeeze (GlobalAver  (None, 480)         0           ['block4c_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block4c_se_reshape (Reshape)   (None, 1, 1, 480)    0           ['block4c_se_squeeze[0][0]']     \n","                                                                                                  \n"," block4c_se_reduce (Conv2D)     (None, 1, 1, 20)     9620        ['block4c_se_reshape[0][0]']     \n","                                                                                                  \n"," block4c_se_expand (Conv2D)     (None, 1, 1, 480)    10080       ['block4c_se_reduce[0][0]']      \n","                                                                                                  \n"," block4c_se_excite (Multiply)   (None, 14, 14, 480)  0           ['block4c_activation[0][0]',     \n","                                                                  'block4c_se_expand[0][0]']      \n","                                                                                                  \n"," block4c_project_conv (Conv2D)  (None, 14, 14, 80)   38400       ['block4c_se_excite[0][0]']      \n","                                                                                                  \n"," block4c_project_bn (BatchNorma  (None, 14, 14, 80)  320         ['block4c_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block4c_drop (Dropout)         (None, 14, 14, 80)   0           ['block4c_project_bn[0][0]']     \n","                                                                                                  \n"," block4c_add (Add)              (None, 14, 14, 80)   0           ['block4c_drop[0][0]',           \n","                                                                  'block4b_add[0][0]']            \n","                                                                                                  \n"," block5a_expand_conv (Conv2D)   (None, 14, 14, 480)  38400       ['block4c_add[0][0]']            \n","                                                                                                  \n"," block5a_expand_bn (BatchNormal  (None, 14, 14, 480)  1920       ['block5a_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block5a_expand_activation (Act  (None, 14, 14, 480)  0          ['block5a_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block5a_dwconv (DepthwiseConv2  (None, 14, 14, 480)  12000      ['block5a_expand_activation[0][0]\n"," D)                                                              ']                               \n","                                                                                                  \n"," block5a_bn (BatchNormalization  (None, 14, 14, 480)  1920       ['block5a_dwconv[0][0]']         \n"," )                                                                                                \n","                                                                                                  \n"," block5a_activation (Activation  (None, 14, 14, 480)  0          ['block5a_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block5a_se_squeeze (GlobalAver  (None, 480)         0           ['block5a_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5a_se_reshape (Reshape)   (None, 1, 1, 480)    0           ['block5a_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5a_se_reduce (Conv2D)     (None, 1, 1, 20)     9620        ['block5a_se_reshape[0][0]']     \n","                                                                                                  \n"," block5a_se_expand (Conv2D)     (None, 1, 1, 480)    10080       ['block5a_se_reduce[0][0]']      \n","                                                                                                  \n"," block5a_se_excite (Multiply)   (None, 14, 14, 480)  0           ['block5a_activation[0][0]',     \n","                                                                  'block5a_se_expand[0][0]']      \n","                                                                                                  \n"," block5a_project_conv (Conv2D)  (None, 14, 14, 112)  53760       ['block5a_se_excite[0][0]']      \n","                                                                                                  \n"," block5a_project_bn (BatchNorma  (None, 14, 14, 112)  448        ['block5a_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5b_expand_conv (Conv2D)   (None, 14, 14, 672)  75264       ['block5a_project_bn[0][0]']     \n","                                                                                                  \n"," block5b_expand_bn (BatchNormal  (None, 14, 14, 672)  2688       ['block5b_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block5b_expand_activation (Act  (None, 14, 14, 672)  0          ['block5b_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block5b_dwconv (DepthwiseConv2  (None, 14, 14, 672)  16800      ['block5b_expand_activation[0][0]\n"," D)                                                              ']                               \n","                                                                                                  \n"," block5b_bn (BatchNormalization  (None, 14, 14, 672)  2688       ['block5b_dwconv[0][0]']         \n"," )                                                                                                \n","                                                                                                  \n"," block5b_activation (Activation  (None, 14, 14, 672)  0          ['block5b_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block5b_se_squeeze (GlobalAver  (None, 672)         0           ['block5b_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5b_se_reshape (Reshape)   (None, 1, 1, 672)    0           ['block5b_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5b_se_reduce (Conv2D)     (None, 1, 1, 28)     18844       ['block5b_se_reshape[0][0]']     \n","                                                                                                  \n"," block5b_se_expand (Conv2D)     (None, 1, 1, 672)    19488       ['block5b_se_reduce[0][0]']      \n","                                                                                                  \n"," block5b_se_excite (Multiply)   (None, 14, 14, 672)  0           ['block5b_activation[0][0]',     \n","                                                                  'block5b_se_expand[0][0]']      \n","                                                                                                  \n"," block5b_project_conv (Conv2D)  (None, 14, 14, 112)  75264       ['block5b_se_excite[0][0]']      \n","                                                                                                  \n"," block5b_project_bn (BatchNorma  (None, 14, 14, 112)  448        ['block5b_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5b_drop (Dropout)         (None, 14, 14, 112)  0           ['block5b_project_bn[0][0]']     \n","                                                                                                  \n"," block5b_add (Add)              (None, 14, 14, 112)  0           ['block5b_drop[0][0]',           \n","                                                                  'block5a_project_bn[0][0]']     \n","                                                                                                  \n"," block5c_expand_conv (Conv2D)   (None, 14, 14, 672)  75264       ['block5b_add[0][0]']            \n","                                                                                                  \n"," block5c_expand_bn (BatchNormal  (None, 14, 14, 672)  2688       ['block5c_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block5c_expand_activation (Act  (None, 14, 14, 672)  0          ['block5c_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block5c_dwconv (DepthwiseConv2  (None, 14, 14, 672)  16800      ['block5c_expand_activation[0][0]\n"," D)                                                              ']                               \n","                                                                                                  \n"," block5c_bn (BatchNormalization  (None, 14, 14, 672)  2688       ['block5c_dwconv[0][0]']         \n"," )                                                                                                \n","                                                                                                  \n"," block5c_activation (Activation  (None, 14, 14, 672)  0          ['block5c_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block5c_se_squeeze (GlobalAver  (None, 672)         0           ['block5c_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5c_se_reshape (Reshape)   (None, 1, 1, 672)    0           ['block5c_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5c_se_reduce (Conv2D)     (None, 1, 1, 28)     18844       ['block5c_se_reshape[0][0]']     \n","                                                                                                  \n"," block5c_se_expand (Conv2D)     (None, 1, 1, 672)    19488       ['block5c_se_reduce[0][0]']      \n","                                                                                                  \n"," block5c_se_excite (Multiply)   (None, 14, 14, 672)  0           ['block5c_activation[0][0]',     \n","                                                                  'block5c_se_expand[0][0]']      \n","                                                                                                  \n"," block5c_project_conv (Conv2D)  (None, 14, 14, 112)  75264       ['block5c_se_excite[0][0]']      \n","                                                                                                  \n"," block5c_project_bn (BatchNorma  (None, 14, 14, 112)  448        ['block5c_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5c_drop (Dropout)         (None, 14, 14, 112)  0           ['block5c_project_bn[0][0]']     \n","                                                                                                  \n"," block5c_add (Add)              (None, 14, 14, 112)  0           ['block5c_drop[0][0]',           \n","                                                                  'block5b_add[0][0]']            \n","                                                                                                  \n"," block6a_expand_conv (Conv2D)   (None, 14, 14, 672)  75264       ['block5c_add[0][0]']            \n","                                                                                                  \n"," block6a_expand_bn (BatchNormal  (None, 14, 14, 672)  2688       ['block6a_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6a_expand_activation (Act  (None, 14, 14, 672)  0          ['block6a_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6a_dwconv_pad (ZeroPaddin  (None, 17, 17, 672)  0          ['block6a_expand_activation[0][0]\n"," g2D)                                                            ']                               \n","                                                                                                  \n"," block6a_dwconv (DepthwiseConv2  (None, 7, 7, 672)   16800       ['block6a_dwconv_pad[0][0]']     \n"," D)                                                                                               \n","                                                                                                  \n"," block6a_bn (BatchNormalization  (None, 7, 7, 672)   2688        ['block6a_dwconv[0][0]']         \n"," )                                                                                                \n","                                                                                                  \n"," block6a_activation (Activation  (None, 7, 7, 672)   0           ['block6a_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6a_se_squeeze (GlobalAver  (None, 672)         0           ['block6a_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6a_se_reshape (Reshape)   (None, 1, 1, 672)    0           ['block6a_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6a_se_reduce (Conv2D)     (None, 1, 1, 28)     18844       ['block6a_se_reshape[0][0]']     \n","                                                                                                  \n"," block6a_se_expand (Conv2D)     (None, 1, 1, 672)    19488       ['block6a_se_reduce[0][0]']      \n","                                                                                                  \n"," block6a_se_excite (Multiply)   (None, 7, 7, 672)    0           ['block6a_activation[0][0]',     \n","                                                                  'block6a_se_expand[0][0]']      \n","                                                                                                  \n"," block6a_project_conv (Conv2D)  (None, 7, 7, 192)    129024      ['block6a_se_excite[0][0]']      \n","                                                                                                  \n"," block6a_project_bn (BatchNorma  (None, 7, 7, 192)   768         ['block6a_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6b_expand_conv (Conv2D)   (None, 7, 7, 1152)   221184      ['block6a_project_bn[0][0]']     \n","                                                                                                  \n"," block6b_expand_bn (BatchNormal  (None, 7, 7, 1152)  4608        ['block6b_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6b_expand_activation (Act  (None, 7, 7, 1152)  0           ['block6b_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6b_dwconv (DepthwiseConv2  (None, 7, 7, 1152)  28800       ['block6b_expand_activation[0][0]\n"," D)                                                              ']                               \n","                                                                                                  \n"," block6b_bn (BatchNormalization  (None, 7, 7, 1152)  4608        ['block6b_dwconv[0][0]']         \n"," )                                                                                                \n","                                                                                                  \n"," block6b_activation (Activation  (None, 7, 7, 1152)  0           ['block6b_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6b_se_squeeze (GlobalAver  (None, 1152)        0           ['block6b_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6b_se_reshape (Reshape)   (None, 1, 1, 1152)   0           ['block6b_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6b_se_reduce (Conv2D)     (None, 1, 1, 48)     55344       ['block6b_se_reshape[0][0]']     \n","                                                                                                  \n"," block6b_se_expand (Conv2D)     (None, 1, 1, 1152)   56448       ['block6b_se_reduce[0][0]']      \n","                                                                                                  \n"," block6b_se_excite (Multiply)   (None, 7, 7, 1152)   0           ['block6b_activation[0][0]',     \n","                                                                  'block6b_se_expand[0][0]']      \n","                                                                                                  \n"," block6b_project_conv (Conv2D)  (None, 7, 7, 192)    221184      ['block6b_se_excite[0][0]']      \n","                                                                                                  \n"," block6b_project_bn (BatchNorma  (None, 7, 7, 192)   768         ['block6b_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6b_drop (Dropout)         (None, 7, 7, 192)    0           ['block6b_project_bn[0][0]']     \n","                                                                                                  \n"," block6b_add (Add)              (None, 7, 7, 192)    0           ['block6b_drop[0][0]',           \n","                                                                  'block6a_project_bn[0][0]']     \n","                                                                                                  \n"," block6c_expand_conv (Conv2D)   (None, 7, 7, 1152)   221184      ['block6b_add[0][0]']            \n","                                                                                                  \n"," block6c_expand_bn (BatchNormal  (None, 7, 7, 1152)  4608        ['block6c_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6c_expand_activation (Act  (None, 7, 7, 1152)  0           ['block6c_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6c_dwconv (DepthwiseConv2  (None, 7, 7, 1152)  28800       ['block6c_expand_activation[0][0]\n"," D)                                                              ']                               \n","                                                                                                  \n"," block6c_bn (BatchNormalization  (None, 7, 7, 1152)  4608        ['block6c_dwconv[0][0]']         \n"," )                                                                                                \n","                                                                                                  \n"," block6c_activation (Activation  (None, 7, 7, 1152)  0           ['block6c_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6c_se_squeeze (GlobalAver  (None, 1152)        0           ['block6c_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6c_se_reshape (Reshape)   (None, 1, 1, 1152)   0           ['block6c_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6c_se_reduce (Conv2D)     (None, 1, 1, 48)     55344       ['block6c_se_reshape[0][0]']     \n","                                                                                                  \n"," block6c_se_expand (Conv2D)     (None, 1, 1, 1152)   56448       ['block6c_se_reduce[0][0]']      \n","                                                                                                  \n"," block6c_se_excite (Multiply)   (None, 7, 7, 1152)   0           ['block6c_activation[0][0]',     \n","                                                                  'block6c_se_expand[0][0]']      \n","                                                                                                  \n"," block6c_project_conv (Conv2D)  (None, 7, 7, 192)    221184      ['block6c_se_excite[0][0]']      \n","                                                                                                  \n"," block6c_project_bn (BatchNorma  (None, 7, 7, 192)   768         ['block6c_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6c_drop (Dropout)         (None, 7, 7, 192)    0           ['block6c_project_bn[0][0]']     \n","                                                                                                  \n"," block6c_add (Add)              (None, 7, 7, 192)    0           ['block6c_drop[0][0]',           \n","                                                                  'block6b_add[0][0]']            \n","                                                                                                  \n"," block6d_expand_conv (Conv2D)   (None, 7, 7, 1152)   221184      ['block6c_add[0][0]']            \n","                                                                                                  \n"," block6d_expand_bn (BatchNormal  (None, 7, 7, 1152)  4608        ['block6d_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6d_expand_activation (Act  (None, 7, 7, 1152)  0           ['block6d_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6d_dwconv (DepthwiseConv2  (None, 7, 7, 1152)  28800       ['block6d_expand_activation[0][0]\n"," D)                                                              ']                               \n","                                                                                                  \n"," block6d_bn (BatchNormalization  (None, 7, 7, 1152)  4608        ['block6d_dwconv[0][0]']         \n"," )                                                                                                \n","                                                                                                  \n"," block6d_activation (Activation  (None, 7, 7, 1152)  0           ['block6d_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6d_se_squeeze (GlobalAver  (None, 1152)        0           ['block6d_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6d_se_reshape (Reshape)   (None, 1, 1, 1152)   0           ['block6d_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6d_se_reduce (Conv2D)     (None, 1, 1, 48)     55344       ['block6d_se_reshape[0][0]']     \n","                                                                                                  \n"," block6d_se_expand (Conv2D)     (None, 1, 1, 1152)   56448       ['block6d_se_reduce[0][0]']      \n","                                                                                                  \n"," block6d_se_excite (Multiply)   (None, 7, 7, 1152)   0           ['block6d_activation[0][0]',     \n","                                                                  'block6d_se_expand[0][0]']      \n","                                                                                                  \n"," block6d_project_conv (Conv2D)  (None, 7, 7, 192)    221184      ['block6d_se_excite[0][0]']      \n","                                                                                                  \n"," block6d_project_bn (BatchNorma  (None, 7, 7, 192)   768         ['block6d_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6d_drop (Dropout)         (None, 7, 7, 192)    0           ['block6d_project_bn[0][0]']     \n","                                                                                                  \n"," block6d_add (Add)              (None, 7, 7, 192)    0           ['block6d_drop[0][0]',           \n","                                                                  'block6c_add[0][0]']            \n","                                                                                                  \n"," block7a_expand_conv (Conv2D)   (None, 7, 7, 1152)   221184      ['block6d_add[0][0]']            \n","                                                                                                  \n"," block7a_expand_bn (BatchNormal  (None, 7, 7, 1152)  4608        ['block7a_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block7a_expand_activation (Act  (None, 7, 7, 1152)  0           ['block7a_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block7a_dwconv (DepthwiseConv2  (None, 7, 7, 1152)  10368       ['block7a_expand_activation[0][0]\n"," D)                                                              ']                               \n","                                                                                                  \n"," block7a_bn (BatchNormalization  (None, 7, 7, 1152)  4608        ['block7a_dwconv[0][0]']         \n"," )                                                                                                \n","                                                                                                  \n"," block7a_activation (Activation  (None, 7, 7, 1152)  0           ['block7a_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block7a_se_squeeze (GlobalAver  (None, 1152)        0           ['block7a_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block7a_se_reshape (Reshape)   (None, 1, 1, 1152)   0           ['block7a_se_squeeze[0][0]']     \n","                                                                                                  \n"," block7a_se_reduce (Conv2D)     (None, 1, 1, 48)     55344       ['block7a_se_reshape[0][0]']     \n","                                                                                                  \n"," block7a_se_expand (Conv2D)     (None, 1, 1, 1152)   56448       ['block7a_se_reduce[0][0]']      \n","                                                                                                  \n"," block7a_se_excite (Multiply)   (None, 7, 7, 1152)   0           ['block7a_activation[0][0]',     \n","                                                                  'block7a_se_expand[0][0]']      \n","                                                                                                  \n"," block7a_project_conv (Conv2D)  (None, 7, 7, 320)    368640      ['block7a_se_excite[0][0]']      \n","                                                                                                  \n"," block7a_project_bn (BatchNorma  (None, 7, 7, 320)   1280        ['block7a_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," top_conv (Conv2D)              (None, 7, 7, 1280)   409600      ['block7a_project_bn[0][0]']     \n","                                                                                                  \n"," top_bn (BatchNormalization)    (None, 7, 7, 1280)   5120        ['top_conv[0][0]']               \n","                                                                                                  \n"," top_activation (Activation)    (None, 7, 7, 1280)   0           ['top_bn[0][0]']                 \n","                                                                                                  \n","==================================================================================================\n","Total params: 4,049,571\n","Trainable params: 4,007,548\n","Non-trainable params: 42,023\n","__________________________________________________________________________________________________\n"]}]},{"cell_type":"code","source":["from keras import layers\n","from keras import models\n","\n","model = models.Sequential()\n","model.add(conv_base)\n","model.add(layers.Flatten())\n","model.add(layers.Dense(1024, activation='relu'))\n","model.add(layers.Dropout(0.5))\n","model.add(layers.Dense(15, activation='softmax'))"],"metadata":{"id":"LwZNYAVrriQN"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["model.summary()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"EKvt6ioQ2IoU","executionInfo":{"status":"ok","timestamp":1649919979927,"user_tz":-300,"elapsed":260,"user":{"displayName":"Даниил Маненок","userId":"11391168364756720378"}},"outputId":"faaf1caf-eb92-4469-eb56-6accc43e017d"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Model: \"sequential_5\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," efficientnetb0 (Functional)  (None, 7, 7, 1280)       4049571   \n","                                                                 \n"," flatten_5 (Flatten)         (None, 62720)             0         \n","                                                                 \n"," dense_10 (Dense)            (None, 1024)              64226304  \n","                                                                 \n"," dropout (Dropout)           (None, 1024)              0         \n","                                                                 \n"," dense_11 (Dense)            (None, 15)                15375     \n","                                                                 \n","=================================================================\n","Total params: 68,291,250\n","Trainable params: 64,241,679\n","Non-trainable params: 4,049,571\n","_________________________________________________________________\n"]}]},{"cell_type":"code","source":["conv_base.trainable = False"],"metadata":{"id":"C5SlOKrwriS4"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from keras.preprocessing.image import ImageDataGenerator\n","\n","batch = 256\n","\n","train_datagen = ImageDataGenerator(\n","    rotation_range=40,\n","    width_shift_range=0.2,\n","    height_shift_range=0.2,\n","    shear_range=0.2,\n","    zoom_range=0.2,\n","    horizontal_flip=True,\n","    fill_mode='nearest')\n","\n","validation_datagen = ImageDataGenerator()\n","\n","test_datagen = ImageDataGenerator()\n","\n","train_generator = train_datagen.flow_from_directory(\n","    train_dir,\n","    target_size=(224, 224),\n","    batch_size=batch,\n","    class_mode='categorical',\n","    shuffle=True)\n","\n","validation_generator = validation_datagen.flow_from_directory(\n","    validation_dir,\n","    target_size=(224, 224),\n","    batch_size=batch,\n","    class_mode='categorical',\n","    shuffle=True)\n","\n","test_generator = test_datagen.flow_from_directory(\n","    test_dir,\n","    target_size=(224, 224),\n","    batch_size=batch,\n","    class_mode='categorical',\n","    shuffle=True)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"5TZDuBR2riVv","executionInfo":{"status":"ok","timestamp":1649920008720,"user_tz":-300,"elapsed":634,"user":{"displayName":"Даниил Маненок","userId":"11391168364756720378"}},"outputId":"d0d32834-7d8d-46d1-e099-87fde3cb4dec"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Found 6000 images belonging to 15 classes.\n","Found 1500 images belonging to 15 classes.\n","Found 1500 images belonging to 15 classes.\n"]}]},{"cell_type":"code","source":["train_stop = 6000//batch\n","validation_stop = 1500//batch\n","test_stop = 1500//batch"],"metadata":{"id":"vpT0f-2V1lK4"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from tensorflow.keras import optimizers\n","\n","model.compile(loss='categorical_crossentropy',\n","              optimizer=optimizers.RMSprop(learning_rate=1e-4),\n","              metrics=['acc'])"],"metadata":{"id":"kfKk9mjx1Ing"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["history = model.fit(train_generator,\n","                    steps_per_epoch=train_stop,\n","                    epochs=10,\n","                    validation_data=validation_generator,\n","                    validation_steps=validation_stop)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"L2OAsVhariYX","executionInfo":{"status":"ok","timestamp":1649924202173,"user_tz":-300,"elapsed":4184221,"user":{"displayName":"Даниил Маненок","userId":"11391168364756720378"}},"outputId":"a6dacd2d-bbb6-40f8-c838-52ce9fb0d0bb"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/10\n","23/23 [==============================] - 447s 19s/step - loss: 1.7724 - acc: 0.6078 - val_loss: 0.3572 - val_acc: 0.8828\n","Epoch 2/10\n","23/23 [==============================] - 389s 17s/step - loss: 0.6517 - acc: 0.7897 - val_loss: 0.2890 - val_acc: 0.8977\n","Epoch 3/10\n","23/23 [==============================] - 402s 18s/step - loss: 0.5053 - acc: 0.8264 - val_loss: 0.3112 - val_acc: 0.8891\n","Epoch 4/10\n","23/23 [==============================] - 398s 17s/step - loss: 0.4395 - acc: 0.8492 - val_loss: 0.2896 - val_acc: 0.8984\n","Epoch 5/10\n","23/23 [==============================] - 391s 17s/step - loss: 0.4094 - acc: 0.8569 - val_loss: 0.2724 - val_acc: 0.9008\n","Epoch 6/10\n","23/23 [==============================] - 404s 18s/step - loss: 0.3757 - acc: 0.8621 - val_loss: 0.2605 - val_acc: 0.9070\n","Epoch 7/10\n","23/23 [==============================] - 408s 18s/step - loss: 0.3376 - acc: 0.8779 - val_loss: 0.2363 - val_acc: 0.9141\n","Epoch 8/10\n","23/23 [==============================] - 392s 17s/step - loss: 0.3190 - acc: 0.8860 - val_loss: 0.2524 - val_acc: 0.9094\n","Epoch 9/10\n","23/23 [==============================] - 394s 17s/step - loss: 0.3106 - acc: 0.8907 - val_loss: 0.2226 - val_acc: 0.9148\n","Epoch 10/10\n","23/23 [==============================] - 374s 16s/step - loss: 0.3066 - acc: 0.8910 - val_loss: 0.2345 - val_acc: 0.9250\n"]}]},{"cell_type":"code","source":["test_loss, test_acc = model.evaluate(test_generator, steps=test_stop)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"EuqtnLBkribF","executionInfo":{"status":"ok","timestamp":1649924302518,"user_tz":-300,"elapsed":92689,"user":{"displayName":"Даниил Маненок","userId":"11391168364756720378"}},"outputId":"6287fee1-b8e4-4b22-9900-d6955e4203df"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["5/5 [==============================] - 55s 11s/step - loss: 0.2158 - acc: 0.9297\n"]}]},{"cell_type":"code","source":["# Дообучение"],"metadata":{"id":"B1gFPWat93_B"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["name = 'top_conv'\n","\n","conv_base.trainable = True\n","set_trainable = False\n","for layer in conv_base.layers:\n","  if layer.name == name:\n","    set_trainable = True\n","  if set_trainable:\n","    layer.trainable = True\n","  else:\n","    layer.trainable = False"],"metadata":{"id":"2M9C7DKd83AY"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["model.summary()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"5Je3R5j6J84g","executionInfo":{"status":"ok","timestamp":1649924497616,"user_tz":-300,"elapsed":276,"user":{"displayName":"Даниил Маненок","userId":"11391168364756720378"}},"outputId":"149158b0-25f4-4d48-9b13-30b2da63b3cc"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Model: \"sequential_5\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," efficientnetb0 (Functional)  (None, 7, 7, 1280)       4049571   \n","                                                                 \n"," flatten_5 (Flatten)         (None, 62720)             0         \n","                                                                 \n"," dense_10 (Dense)            (None, 1024)              64226304  \n","                                                                 \n"," dropout (Dropout)           (None, 1024)              0         \n","                                                                 \n"," dense_11 (Dense)            (None, 15)                15375     \n","                                                                 \n","=================================================================\n","Total params: 68,291,250\n","Trainable params: 64,653,839\n","Non-trainable params: 3,637,411\n","_________________________________________________________________\n"]}]},{"cell_type":"code","source":["model.compile(loss='categorical_crossentropy',\n","              optimizer=optimizers.RMSprop(learning_rate=1e-5),\n","              metrics=['acc'])"],"metadata":{"id":"ODe7_8_VKEHw"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["history = model.fit(train_generator,\n","                    steps_per_epoch=train_stop,\n","                    epochs=20,\n","                    validation_data=validation_generator,\n","                    validation_steps=validation_stop)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"DWAYYcEOLvM_","executionInfo":{"status":"ok","timestamp":1649933029019,"user_tz":-300,"elapsed":8146312,"user":{"displayName":"Даниил Маненок","userId":"11391168364756720378"}},"outputId":"df5f758e-3c5c-4cf9-f295-7fafc86585a2"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/20\n","23/23 [==============================] - 428s 18s/step - loss: 0.3119 - acc: 0.9011 - val_loss: 0.2391 - val_acc: 0.9234\n","Epoch 2/20\n","23/23 [==============================] - 390s 17s/step - loss: 0.2823 - acc: 0.9056 - val_loss: 0.2353 - val_acc: 0.9258\n","Epoch 3/20\n","23/23 [==============================] - 390s 17s/step - loss: 0.2468 - acc: 0.9163 - val_loss: 0.2268 - val_acc: 0.9305\n","Epoch 4/20\n","23/23 [==============================] - 393s 17s/step - loss: 0.2497 - acc: 0.9116 - val_loss: 0.2326 - val_acc: 0.9242\n","Epoch 5/20\n","23/23 [==============================] - 390s 17s/step - loss: 0.2442 - acc: 0.9175 - val_loss: 0.2155 - val_acc: 0.9227\n","Epoch 6/20\n","23/23 [==============================] - 401s 18s/step - loss: 0.2505 - acc: 0.9119 - val_loss: 0.2254 - val_acc: 0.9227\n","Epoch 7/20\n","23/23 [==============================] - 395s 17s/step - loss: 0.2322 - acc: 0.9199 - val_loss: 0.2374 - val_acc: 0.9250\n","Epoch 8/20\n","23/23 [==============================] - 389s 17s/step - loss: 0.2331 - acc: 0.9190 - val_loss: 0.2490 - val_acc: 0.9187\n","Epoch 9/20\n","23/23 [==============================] - 392s 17s/step - loss: 0.2136 - acc: 0.9232 - val_loss: 0.2445 - val_acc: 0.9227\n","Epoch 10/20\n","23/23 [==============================] - 391s 17s/step - loss: 0.2206 - acc: 0.9222 - val_loss: 0.2452 - val_acc: 0.9227\n","Epoch 11/20\n","23/23 [==============================] - 391s 17s/step - loss: 0.2040 - acc: 0.9267 - val_loss: 0.2312 - val_acc: 0.9250\n","Epoch 12/20\n","23/23 [==============================] - 372s 16s/step - loss: 0.2121 - acc: 0.9257 - val_loss: 0.2474 - val_acc: 0.9242\n","Epoch 13/20\n","23/23 [==============================] - 374s 16s/step - loss: 0.1922 - acc: 0.9262 - val_loss: 0.2237 - val_acc: 0.9250\n","Epoch 14/20\n","23/23 [==============================] - 375s 16s/step - loss: 0.1928 - acc: 0.9297 - val_loss: 0.2254 - val_acc: 0.9328\n","Epoch 15/20\n","23/23 [==============================] - 359s 16s/step - loss: 0.1849 - acc: 0.9314 - val_loss: 0.2407 - val_acc: 0.9281\n","Epoch 16/20\n","23/23 [==============================] - 391s 17s/step - loss: 0.1903 - acc: 0.9333 - val_loss: 0.2471 - val_acc: 0.9281\n","Epoch 17/20\n","23/23 [==============================] - 372s 16s/step - loss: 0.2060 - acc: 0.9286 - val_loss: 0.2049 - val_acc: 0.9320\n","Epoch 18/20\n","23/23 [==============================] - 377s 17s/step - loss: 0.1791 - acc: 0.9295 - val_loss: 0.2120 - val_acc: 0.9336\n","Epoch 19/20\n","23/23 [==============================] - 375s 16s/step - loss: 0.1694 - acc: 0.9398 - val_loss: 0.2422 - val_acc: 0.9289\n","Epoch 20/20\n","23/23 [==============================] - 389s 17s/step - loss: 0.1792 - acc: 0.9352 - val_loss: 0.2411 - val_acc: 0.9273\n"]}]},{"cell_type":"code","source":["test_loss, test_acc = model.evaluate(test_generator, steps=test_stop)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"DxAOo2lQL76J","executionInfo":{"status":"ok","timestamp":1649933123408,"user_tz":-300,"elapsed":73678,"user":{"displayName":"Даниил Маненок","userId":"11391168364756720378"}},"outputId":"17bb5f90-f0e0-4144-95f2-438357ef3464"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["5/5 [==============================] - 54s 11s/step - loss: 0.2064 - acc: 0.9383\n"]}]},{"cell_type":"code","source":["model.save('9383.h5')"],"metadata":{"id":"nw89QyDVrFz6"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# EfficientNetV2L"],"metadata":{"id":"tw8e8-nTwMjK"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["conv_base = tf.keras.applications.EfficientNetV2L(\n","    include_top=False,\n","    weights=\"imagenet\",\n","    input_shape=(224, 224, 3))"],"metadata":{"id":"hKik7yEXtE9t"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["conv_base.summary()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"PKqod3zVvbFw","executionInfo":{"status":"ok","timestamp":1649934457023,"user_tz":-300,"elapsed":15864,"user":{"displayName":"Даниил Маненок","userId":"11391168364756720378"}},"outputId":"faa9f41d-d613-4812-9ef9-ceee841c057b"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Model: \"efficientnetv2-l\"\n","__________________________________________________________________________________________________\n"," Layer (type)                   Output Shape         Param #     Connected to                     \n","==================================================================================================\n"," input_4 (InputLayer)           [(None, 224, 224, 3  0           []                               \n","                                )]                                                                \n","                                                                                                  \n"," rescaling_3 (Rescaling)        (None, 224, 224, 3)  0           ['input_4[0][0]']                \n","                                                                                                  \n"," stem_conv (Conv2D)             (None, 112, 112, 32  864         ['rescaling_3[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," stem_bn (BatchNormalization)   (None, 112, 112, 32  128         ['stem_conv[0][0]']              \n","                                )                                                                 \n","                                                                                                  \n"," stem_activation (Activation)   (None, 112, 112, 32  0           ['stem_bn[0][0]']                \n","                                )                                                                 \n","                                                                                                  \n"," block1a_project_conv (Conv2D)  (None, 112, 112, 32  9216        ['stem_activation[0][0]']        \n","                                )                                                                 \n","                                                                                                  \n"," block1a_project_bn (BatchNorma  (None, 112, 112, 32  128        ['block1a_project_conv[0][0]']   \n"," lization)                      )                                                                 \n","                                                                                                  \n"," block1a_project_activation (Ac  (None, 112, 112, 32  0          ['block1a_project_bn[0][0]']     \n"," tivation)                      )                                                                 \n","                                                                                                  \n"," block1a_add (Add)              (None, 112, 112, 32  0           ['block1a_project_activation[0][0\n","                                )                                ]',                              \n","                                                                  'stem_activation[0][0]']        \n","                                                                                                  \n"," block1b_project_conv (Conv2D)  (None, 112, 112, 32  9216        ['block1a_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block1b_project_bn (BatchNorma  (None, 112, 112, 32  128        ['block1b_project_conv[0][0]']   \n"," lization)                      )                                                                 \n","                                                                                                  \n"," block1b_project_activation (Ac  (None, 112, 112, 32  0          ['block1b_project_bn[0][0]']     \n"," tivation)                      )                                                                 \n","                                                                                                  \n"," block1b_add (Add)              (None, 112, 112, 32  0           ['block1b_project_activation[0][0\n","                                )                                ]',                              \n","                                                                  'block1a_add[0][0]']            \n","                                                                                                  \n"," block1c_project_conv (Conv2D)  (None, 112, 112, 32  9216        ['block1b_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block1c_project_bn (BatchNorma  (None, 112, 112, 32  128        ['block1c_project_conv[0][0]']   \n"," lization)                      )                                                                 \n","                                                                                                  \n"," block1c_project_activation (Ac  (None, 112, 112, 32  0          ['block1c_project_bn[0][0]']     \n"," tivation)                      )                                                                 \n","                                                                                                  \n"," block1c_add (Add)              (None, 112, 112, 32  0           ['block1c_project_activation[0][0\n","                                )                                ]',                              \n","                                                                  'block1b_add[0][0]']            \n","                                                                                                  \n"," block1d_project_conv (Conv2D)  (None, 112, 112, 32  9216        ['block1c_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block1d_project_bn (BatchNorma  (None, 112, 112, 32  128        ['block1d_project_conv[0][0]']   \n"," lization)                      )                                                                 \n","                                                                                                  \n"," block1d_project_activation (Ac  (None, 112, 112, 32  0          ['block1d_project_bn[0][0]']     \n"," tivation)                      )                                                                 \n","                                                                                                  \n"," block1d_add (Add)              (None, 112, 112, 32  0           ['block1d_project_activation[0][0\n","                                )                                ]',                              \n","                                                                  'block1c_add[0][0]']            \n","                                                                                                  \n"," block2a_expand_conv (Conv2D)   (None, 56, 56, 128)  36864       ['block1d_add[0][0]']            \n","                                                                                                  \n"," block2a_expand_bn (BatchNormal  (None, 56, 56, 128)  512        ['block2a_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block2a_expand_activation (Act  (None, 56, 56, 128)  0          ['block2a_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block2a_project_conv (Conv2D)  (None, 56, 56, 64)   8192        ['block2a_expand_activation[0][0]\n","                                                                 ']                               \n","                                                                                                  \n"," block2a_project_bn (BatchNorma  (None, 56, 56, 64)  256         ['block2a_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block2b_expand_conv (Conv2D)   (None, 56, 56, 256)  147456      ['block2a_project_bn[0][0]']     \n","                                                                                                  \n"," block2b_expand_bn (BatchNormal  (None, 56, 56, 256)  1024       ['block2b_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block2b_expand_activation (Act  (None, 56, 56, 256)  0          ['block2b_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block2b_project_conv (Conv2D)  (None, 56, 56, 64)   16384       ['block2b_expand_activation[0][0]\n","                                                                 ']                               \n","                                                                                                  \n"," block2b_project_bn (BatchNorma  (None, 56, 56, 64)  256         ['block2b_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block2b_add (Add)              (None, 56, 56, 64)   0           ['block2b_project_bn[0][0]',     \n","                                                                  'block2a_project_bn[0][0]']     \n","                                                                                                  \n"," block2c_expand_conv (Conv2D)   (None, 56, 56, 256)  147456      ['block2b_add[0][0]']            \n","                                                                                                  \n"," block2c_expand_bn (BatchNormal  (None, 56, 56, 256)  1024       ['block2c_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block2c_expand_activation (Act  (None, 56, 56, 256)  0          ['block2c_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block2c_project_conv (Conv2D)  (None, 56, 56, 64)   16384       ['block2c_expand_activation[0][0]\n","                                                                 ']                               \n","                                                                                                  \n"," block2c_project_bn (BatchNorma  (None, 56, 56, 64)  256         ['block2c_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block2c_add (Add)              (None, 56, 56, 64)   0           ['block2c_project_bn[0][0]',     \n","                                                                  'block2b_add[0][0]']            \n","                                                                                                  \n"," block2d_expand_conv (Conv2D)   (None, 56, 56, 256)  147456      ['block2c_add[0][0]']            \n","                                                                                                  \n"," block2d_expand_bn (BatchNormal  (None, 56, 56, 256)  1024       ['block2d_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block2d_expand_activation (Act  (None, 56, 56, 256)  0          ['block2d_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block2d_project_conv (Conv2D)  (None, 56, 56, 64)   16384       ['block2d_expand_activation[0][0]\n","                                                                 ']                               \n","                                                                                                  \n"," block2d_project_bn (BatchNorma  (None, 56, 56, 64)  256         ['block2d_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block2d_add (Add)              (None, 56, 56, 64)   0           ['block2d_project_bn[0][0]',     \n","                                                                  'block2c_add[0][0]']            \n","                                                                                                  \n"," block2e_expand_conv (Conv2D)   (None, 56, 56, 256)  147456      ['block2d_add[0][0]']            \n","                                                                                                  \n"," block2e_expand_bn (BatchNormal  (None, 56, 56, 256)  1024       ['block2e_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block2e_expand_activation (Act  (None, 56, 56, 256)  0          ['block2e_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block2e_project_conv (Conv2D)  (None, 56, 56, 64)   16384       ['block2e_expand_activation[0][0]\n","                                                                 ']                               \n","                                                                                                  \n"," block2e_project_bn (BatchNorma  (None, 56, 56, 64)  256         ['block2e_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block2e_add (Add)              (None, 56, 56, 64)   0           ['block2e_project_bn[0][0]',     \n","                                                                  'block2d_add[0][0]']            \n","                                                                                                  \n"," block2f_expand_conv (Conv2D)   (None, 56, 56, 256)  147456      ['block2e_add[0][0]']            \n","                                                                                                  \n"," block2f_expand_bn (BatchNormal  (None, 56, 56, 256)  1024       ['block2f_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block2f_expand_activation (Act  (None, 56, 56, 256)  0          ['block2f_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block2f_project_conv (Conv2D)  (None, 56, 56, 64)   16384       ['block2f_expand_activation[0][0]\n","                                                                 ']                               \n","                                                                                                  \n"," block2f_project_bn (BatchNorma  (None, 56, 56, 64)  256         ['block2f_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block2f_add (Add)              (None, 56, 56, 64)   0           ['block2f_project_bn[0][0]',     \n","                                                                  'block2e_add[0][0]']            \n","                                                                                                  \n"," block2g_expand_conv (Conv2D)   (None, 56, 56, 256)  147456      ['block2f_add[0][0]']            \n","                                                                                                  \n"," block2g_expand_bn (BatchNormal  (None, 56, 56, 256)  1024       ['block2g_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block2g_expand_activation (Act  (None, 56, 56, 256)  0          ['block2g_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block2g_project_conv (Conv2D)  (None, 56, 56, 64)   16384       ['block2g_expand_activation[0][0]\n","                                                                 ']                               \n","                                                                                                  \n"," block2g_project_bn (BatchNorma  (None, 56, 56, 64)  256         ['block2g_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block2g_add (Add)              (None, 56, 56, 64)   0           ['block2g_project_bn[0][0]',     \n","                                                                  'block2f_add[0][0]']            \n","                                                                                                  \n"," block3a_expand_conv (Conv2D)   (None, 28, 28, 256)  147456      ['block2g_add[0][0]']            \n","                                                                                                  \n"," block3a_expand_bn (BatchNormal  (None, 28, 28, 256)  1024       ['block3a_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block3a_expand_activation (Act  (None, 28, 28, 256)  0          ['block3a_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block3a_project_conv (Conv2D)  (None, 28, 28, 96)   24576       ['block3a_expand_activation[0][0]\n","                                                                 ']                               \n","                                                                                                  \n"," block3a_project_bn (BatchNorma  (None, 28, 28, 96)  384         ['block3a_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block3b_expand_conv (Conv2D)   (None, 28, 28, 384)  331776      ['block3a_project_bn[0][0]']     \n","                                                                                                  \n"," block3b_expand_bn (BatchNormal  (None, 28, 28, 384)  1536       ['block3b_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block3b_expand_activation (Act  (None, 28, 28, 384)  0          ['block3b_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block3b_project_conv (Conv2D)  (None, 28, 28, 96)   36864       ['block3b_expand_activation[0][0]\n","                                                                 ']                               \n","                                                                                                  \n"," block3b_project_bn (BatchNorma  (None, 28, 28, 96)  384         ['block3b_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block3b_add (Add)              (None, 28, 28, 96)   0           ['block3b_project_bn[0][0]',     \n","                                                                  'block3a_project_bn[0][0]']     \n","                                                                                                  \n"," block3c_expand_conv (Conv2D)   (None, 28, 28, 384)  331776      ['block3b_add[0][0]']            \n","                                                                                                  \n"," block3c_expand_bn (BatchNormal  (None, 28, 28, 384)  1536       ['block3c_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block3c_expand_activation (Act  (None, 28, 28, 384)  0          ['block3c_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block3c_project_conv (Conv2D)  (None, 28, 28, 96)   36864       ['block3c_expand_activation[0][0]\n","                                                                 ']                               \n","                                                                                                  \n"," block3c_project_bn (BatchNorma  (None, 28, 28, 96)  384         ['block3c_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block3c_add (Add)              (None, 28, 28, 96)   0           ['block3c_project_bn[0][0]',     \n","                                                                  'block3b_add[0][0]']            \n","                                                                                                  \n"," block3d_expand_conv (Conv2D)   (None, 28, 28, 384)  331776      ['block3c_add[0][0]']            \n","                                                                                                  \n"," block3d_expand_bn (BatchNormal  (None, 28, 28, 384)  1536       ['block3d_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block3d_expand_activation (Act  (None, 28, 28, 384)  0          ['block3d_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block3d_project_conv (Conv2D)  (None, 28, 28, 96)   36864       ['block3d_expand_activation[0][0]\n","                                                                 ']                               \n","                                                                                                  \n"," block3d_project_bn (BatchNorma  (None, 28, 28, 96)  384         ['block3d_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block3d_add (Add)              (None, 28, 28, 96)   0           ['block3d_project_bn[0][0]',     \n","                                                                  'block3c_add[0][0]']            \n","                                                                                                  \n"," block3e_expand_conv (Conv2D)   (None, 28, 28, 384)  331776      ['block3d_add[0][0]']            \n","                                                                                                  \n"," block3e_expand_bn (BatchNormal  (None, 28, 28, 384)  1536       ['block3e_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block3e_expand_activation (Act  (None, 28, 28, 384)  0          ['block3e_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block3e_project_conv (Conv2D)  (None, 28, 28, 96)   36864       ['block3e_expand_activation[0][0]\n","                                                                 ']                               \n","                                                                                                  \n"," block3e_project_bn (BatchNorma  (None, 28, 28, 96)  384         ['block3e_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block3e_add (Add)              (None, 28, 28, 96)   0           ['block3e_project_bn[0][0]',     \n","                                                                  'block3d_add[0][0]']            \n","                                                                                                  \n"," block3f_expand_conv (Conv2D)   (None, 28, 28, 384)  331776      ['block3e_add[0][0]']            \n","                                                                                                  \n"," block3f_expand_bn (BatchNormal  (None, 28, 28, 384)  1536       ['block3f_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block3f_expand_activation (Act  (None, 28, 28, 384)  0          ['block3f_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block3f_project_conv (Conv2D)  (None, 28, 28, 96)   36864       ['block3f_expand_activation[0][0]\n","                                                                 ']                               \n","                                                                                                  \n"," block3f_project_bn (BatchNorma  (None, 28, 28, 96)  384         ['block3f_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block3f_add (Add)              (None, 28, 28, 96)   0           ['block3f_project_bn[0][0]',     \n","                                                                  'block3e_add[0][0]']            \n","                                                                                                  \n"," block3g_expand_conv (Conv2D)   (None, 28, 28, 384)  331776      ['block3f_add[0][0]']            \n","                                                                                                  \n"," block3g_expand_bn (BatchNormal  (None, 28, 28, 384)  1536       ['block3g_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block3g_expand_activation (Act  (None, 28, 28, 384)  0          ['block3g_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block3g_project_conv (Conv2D)  (None, 28, 28, 96)   36864       ['block3g_expand_activation[0][0]\n","                                                                 ']                               \n","                                                                                                  \n"," block3g_project_bn (BatchNorma  (None, 28, 28, 96)  384         ['block3g_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block3g_add (Add)              (None, 28, 28, 96)   0           ['block3g_project_bn[0][0]',     \n","                                                                  'block3f_add[0][0]']            \n","                                                                                                  \n"," block4a_expand_conv (Conv2D)   (None, 28, 28, 384)  36864       ['block3g_add[0][0]']            \n","                                                                                                  \n"," block4a_expand_bn (BatchNormal  (None, 28, 28, 384)  1536       ['block4a_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block4a_expand_activation (Act  (None, 28, 28, 384)  0          ['block4a_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block4a_dwconv2 (DepthwiseConv  (None, 14, 14, 384)  3456       ['block4a_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block4a_bn (BatchNormalization  (None, 14, 14, 384)  1536       ['block4a_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block4a_activation (Activation  (None, 14, 14, 384)  0          ['block4a_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block4a_se_squeeze (GlobalAver  (None, 384)         0           ['block4a_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block4a_se_reshape (Reshape)   (None, 1, 1, 384)    0           ['block4a_se_squeeze[0][0]']     \n","                                                                                                  \n"," block4a_se_reduce (Conv2D)     (None, 1, 1, 24)     9240        ['block4a_se_reshape[0][0]']     \n","                                                                                                  \n"," block4a_se_expand (Conv2D)     (None, 1, 1, 384)    9600        ['block4a_se_reduce[0][0]']      \n","                                                                                                  \n"," block4a_se_excite (Multiply)   (None, 14, 14, 384)  0           ['block4a_activation[0][0]',     \n","                                                                  'block4a_se_expand[0][0]']      \n","                                                                                                  \n"," block4a_project_conv (Conv2D)  (None, 14, 14, 192)  73728       ['block4a_se_excite[0][0]']      \n","                                                                                                  \n"," block4a_project_bn (BatchNorma  (None, 14, 14, 192)  768        ['block4a_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block4b_expand_conv (Conv2D)   (None, 14, 14, 768)  147456      ['block4a_project_bn[0][0]']     \n","                                                                                                  \n"," block4b_expand_bn (BatchNormal  (None, 14, 14, 768)  3072       ['block4b_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block4b_expand_activation (Act  (None, 14, 14, 768)  0          ['block4b_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block4b_dwconv2 (DepthwiseConv  (None, 14, 14, 768)  6912       ['block4b_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block4b_bn (BatchNormalization  (None, 14, 14, 768)  3072       ['block4b_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block4b_activation (Activation  (None, 14, 14, 768)  0          ['block4b_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block4b_se_squeeze (GlobalAver  (None, 768)         0           ['block4b_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block4b_se_reshape (Reshape)   (None, 1, 1, 768)    0           ['block4b_se_squeeze[0][0]']     \n","                                                                                                  \n"," block4b_se_reduce (Conv2D)     (None, 1, 1, 48)     36912       ['block4b_se_reshape[0][0]']     \n","                                                                                                  \n"," block4b_se_expand (Conv2D)     (None, 1, 1, 768)    37632       ['block4b_se_reduce[0][0]']      \n","                                                                                                  \n"," block4b_se_excite (Multiply)   (None, 14, 14, 768)  0           ['block4b_activation[0][0]',     \n","                                                                  'block4b_se_expand[0][0]']      \n","                                                                                                  \n"," block4b_project_conv (Conv2D)  (None, 14, 14, 192)  147456      ['block4b_se_excite[0][0]']      \n","                                                                                                  \n"," block4b_project_bn (BatchNorma  (None, 14, 14, 192)  768        ['block4b_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block4b_add (Add)              (None, 14, 14, 192)  0           ['block4b_project_bn[0][0]',     \n","                                                                  'block4a_project_bn[0][0]']     \n","                                                                                                  \n"," block4c_expand_conv (Conv2D)   (None, 14, 14, 768)  147456      ['block4b_add[0][0]']            \n","                                                                                                  \n"," block4c_expand_bn (BatchNormal  (None, 14, 14, 768)  3072       ['block4c_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block4c_expand_activation (Act  (None, 14, 14, 768)  0          ['block4c_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block4c_dwconv2 (DepthwiseConv  (None, 14, 14, 768)  6912       ['block4c_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block4c_bn (BatchNormalization  (None, 14, 14, 768)  3072       ['block4c_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block4c_activation (Activation  (None, 14, 14, 768)  0          ['block4c_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block4c_se_squeeze (GlobalAver  (None, 768)         0           ['block4c_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block4c_se_reshape (Reshape)   (None, 1, 1, 768)    0           ['block4c_se_squeeze[0][0]']     \n","                                                                                                  \n"," block4c_se_reduce (Conv2D)     (None, 1, 1, 48)     36912       ['block4c_se_reshape[0][0]']     \n","                                                                                                  \n"," block4c_se_expand (Conv2D)     (None, 1, 1, 768)    37632       ['block4c_se_reduce[0][0]']      \n","                                                                                                  \n"," block4c_se_excite (Multiply)   (None, 14, 14, 768)  0           ['block4c_activation[0][0]',     \n","                                                                  'block4c_se_expand[0][0]']      \n","                                                                                                  \n"," block4c_project_conv (Conv2D)  (None, 14, 14, 192)  147456      ['block4c_se_excite[0][0]']      \n","                                                                                                  \n"," block4c_project_bn (BatchNorma  (None, 14, 14, 192)  768        ['block4c_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block4c_add (Add)              (None, 14, 14, 192)  0           ['block4c_project_bn[0][0]',     \n","                                                                  'block4b_add[0][0]']            \n","                                                                                                  \n"," block4d_expand_conv (Conv2D)   (None, 14, 14, 768)  147456      ['block4c_add[0][0]']            \n","                                                                                                  \n"," block4d_expand_bn (BatchNormal  (None, 14, 14, 768)  3072       ['block4d_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block4d_expand_activation (Act  (None, 14, 14, 768)  0          ['block4d_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block4d_dwconv2 (DepthwiseConv  (None, 14, 14, 768)  6912       ['block4d_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block4d_bn (BatchNormalization  (None, 14, 14, 768)  3072       ['block4d_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block4d_activation (Activation  (None, 14, 14, 768)  0          ['block4d_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block4d_se_squeeze (GlobalAver  (None, 768)         0           ['block4d_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block4d_se_reshape (Reshape)   (None, 1, 1, 768)    0           ['block4d_se_squeeze[0][0]']     \n","                                                                                                  \n"," block4d_se_reduce (Conv2D)     (None, 1, 1, 48)     36912       ['block4d_se_reshape[0][0]']     \n","                                                                                                  \n"," block4d_se_expand (Conv2D)     (None, 1, 1, 768)    37632       ['block4d_se_reduce[0][0]']      \n","                                                                                                  \n"," block4d_se_excite (Multiply)   (None, 14, 14, 768)  0           ['block4d_activation[0][0]',     \n","                                                                  'block4d_se_expand[0][0]']      \n","                                                                                                  \n"," block4d_project_conv (Conv2D)  (None, 14, 14, 192)  147456      ['block4d_se_excite[0][0]']      \n","                                                                                                  \n"," block4d_project_bn (BatchNorma  (None, 14, 14, 192)  768        ['block4d_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block4d_add (Add)              (None, 14, 14, 192)  0           ['block4d_project_bn[0][0]',     \n","                                                                  'block4c_add[0][0]']            \n","                                                                                                  \n"," block4e_expand_conv (Conv2D)   (None, 14, 14, 768)  147456      ['block4d_add[0][0]']            \n","                                                                                                  \n"," block4e_expand_bn (BatchNormal  (None, 14, 14, 768)  3072       ['block4e_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block4e_expand_activation (Act  (None, 14, 14, 768)  0          ['block4e_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block4e_dwconv2 (DepthwiseConv  (None, 14, 14, 768)  6912       ['block4e_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block4e_bn (BatchNormalization  (None, 14, 14, 768)  3072       ['block4e_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block4e_activation (Activation  (None, 14, 14, 768)  0          ['block4e_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block4e_se_squeeze (GlobalAver  (None, 768)         0           ['block4e_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block4e_se_reshape (Reshape)   (None, 1, 1, 768)    0           ['block4e_se_squeeze[0][0]']     \n","                                                                                                  \n"," block4e_se_reduce (Conv2D)     (None, 1, 1, 48)     36912       ['block4e_se_reshape[0][0]']     \n","                                                                                                  \n"," block4e_se_expand (Conv2D)     (None, 1, 1, 768)    37632       ['block4e_se_reduce[0][0]']      \n","                                                                                                  \n"," block4e_se_excite (Multiply)   (None, 14, 14, 768)  0           ['block4e_activation[0][0]',     \n","                                                                  'block4e_se_expand[0][0]']      \n","                                                                                                  \n"," block4e_project_conv (Conv2D)  (None, 14, 14, 192)  147456      ['block4e_se_excite[0][0]']      \n","                                                                                                  \n"," block4e_project_bn (BatchNorma  (None, 14, 14, 192)  768        ['block4e_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block4e_add (Add)              (None, 14, 14, 192)  0           ['block4e_project_bn[0][0]',     \n","                                                                  'block4d_add[0][0]']            \n","                                                                                                  \n"," block4f_expand_conv (Conv2D)   (None, 14, 14, 768)  147456      ['block4e_add[0][0]']            \n","                                                                                                  \n"," block4f_expand_bn (BatchNormal  (None, 14, 14, 768)  3072       ['block4f_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block4f_expand_activation (Act  (None, 14, 14, 768)  0          ['block4f_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block4f_dwconv2 (DepthwiseConv  (None, 14, 14, 768)  6912       ['block4f_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block4f_bn (BatchNormalization  (None, 14, 14, 768)  3072       ['block4f_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block4f_activation (Activation  (None, 14, 14, 768)  0          ['block4f_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block4f_se_squeeze (GlobalAver  (None, 768)         0           ['block4f_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block4f_se_reshape (Reshape)   (None, 1, 1, 768)    0           ['block4f_se_squeeze[0][0]']     \n","                                                                                                  \n"," block4f_se_reduce (Conv2D)     (None, 1, 1, 48)     36912       ['block4f_se_reshape[0][0]']     \n","                                                                                                  \n"," block4f_se_expand (Conv2D)     (None, 1, 1, 768)    37632       ['block4f_se_reduce[0][0]']      \n","                                                                                                  \n"," block4f_se_excite (Multiply)   (None, 14, 14, 768)  0           ['block4f_activation[0][0]',     \n","                                                                  'block4f_se_expand[0][0]']      \n","                                                                                                  \n"," block4f_project_conv (Conv2D)  (None, 14, 14, 192)  147456      ['block4f_se_excite[0][0]']      \n","                                                                                                  \n"," block4f_project_bn (BatchNorma  (None, 14, 14, 192)  768        ['block4f_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block4f_add (Add)              (None, 14, 14, 192)  0           ['block4f_project_bn[0][0]',     \n","                                                                  'block4e_add[0][0]']            \n","                                                                                                  \n"," block4g_expand_conv (Conv2D)   (None, 14, 14, 768)  147456      ['block4f_add[0][0]']            \n","                                                                                                  \n"," block4g_expand_bn (BatchNormal  (None, 14, 14, 768)  3072       ['block4g_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block4g_expand_activation (Act  (None, 14, 14, 768)  0          ['block4g_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block4g_dwconv2 (DepthwiseConv  (None, 14, 14, 768)  6912       ['block4g_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block4g_bn (BatchNormalization  (None, 14, 14, 768)  3072       ['block4g_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block4g_activation (Activation  (None, 14, 14, 768)  0          ['block4g_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block4g_se_squeeze (GlobalAver  (None, 768)         0           ['block4g_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block4g_se_reshape (Reshape)   (None, 1, 1, 768)    0           ['block4g_se_squeeze[0][0]']     \n","                                                                                                  \n"," block4g_se_reduce (Conv2D)     (None, 1, 1, 48)     36912       ['block4g_se_reshape[0][0]']     \n","                                                                                                  \n"," block4g_se_expand (Conv2D)     (None, 1, 1, 768)    37632       ['block4g_se_reduce[0][0]']      \n","                                                                                                  \n"," block4g_se_excite (Multiply)   (None, 14, 14, 768)  0           ['block4g_activation[0][0]',     \n","                                                                  'block4g_se_expand[0][0]']      \n","                                                                                                  \n"," block4g_project_conv (Conv2D)  (None, 14, 14, 192)  147456      ['block4g_se_excite[0][0]']      \n","                                                                                                  \n"," block4g_project_bn (BatchNorma  (None, 14, 14, 192)  768        ['block4g_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block4g_add (Add)              (None, 14, 14, 192)  0           ['block4g_project_bn[0][0]',     \n","                                                                  'block4f_add[0][0]']            \n","                                                                                                  \n"," block4h_expand_conv (Conv2D)   (None, 14, 14, 768)  147456      ['block4g_add[0][0]']            \n","                                                                                                  \n"," block4h_expand_bn (BatchNormal  (None, 14, 14, 768)  3072       ['block4h_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block4h_expand_activation (Act  (None, 14, 14, 768)  0          ['block4h_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block4h_dwconv2 (DepthwiseConv  (None, 14, 14, 768)  6912       ['block4h_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block4h_bn (BatchNormalization  (None, 14, 14, 768)  3072       ['block4h_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block4h_activation (Activation  (None, 14, 14, 768)  0          ['block4h_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block4h_se_squeeze (GlobalAver  (None, 768)         0           ['block4h_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block4h_se_reshape (Reshape)   (None, 1, 1, 768)    0           ['block4h_se_squeeze[0][0]']     \n","                                                                                                  \n"," block4h_se_reduce (Conv2D)     (None, 1, 1, 48)     36912       ['block4h_se_reshape[0][0]']     \n","                                                                                                  \n"," block4h_se_expand (Conv2D)     (None, 1, 1, 768)    37632       ['block4h_se_reduce[0][0]']      \n","                                                                                                  \n"," block4h_se_excite (Multiply)   (None, 14, 14, 768)  0           ['block4h_activation[0][0]',     \n","                                                                  'block4h_se_expand[0][0]']      \n","                                                                                                  \n"," block4h_project_conv (Conv2D)  (None, 14, 14, 192)  147456      ['block4h_se_excite[0][0]']      \n","                                                                                                  \n"," block4h_project_bn (BatchNorma  (None, 14, 14, 192)  768        ['block4h_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block4h_add (Add)              (None, 14, 14, 192)  0           ['block4h_project_bn[0][0]',     \n","                                                                  'block4g_add[0][0]']            \n","                                                                                                  \n"," block4i_expand_conv (Conv2D)   (None, 14, 14, 768)  147456      ['block4h_add[0][0]']            \n","                                                                                                  \n"," block4i_expand_bn (BatchNormal  (None, 14, 14, 768)  3072       ['block4i_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block4i_expand_activation (Act  (None, 14, 14, 768)  0          ['block4i_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block4i_dwconv2 (DepthwiseConv  (None, 14, 14, 768)  6912       ['block4i_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block4i_bn (BatchNormalization  (None, 14, 14, 768)  3072       ['block4i_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block4i_activation (Activation  (None, 14, 14, 768)  0          ['block4i_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block4i_se_squeeze (GlobalAver  (None, 768)         0           ['block4i_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block4i_se_reshape (Reshape)   (None, 1, 1, 768)    0           ['block4i_se_squeeze[0][0]']     \n","                                                                                                  \n"," block4i_se_reduce (Conv2D)     (None, 1, 1, 48)     36912       ['block4i_se_reshape[0][0]']     \n","                                                                                                  \n"," block4i_se_expand (Conv2D)     (None, 1, 1, 768)    37632       ['block4i_se_reduce[0][0]']      \n","                                                                                                  \n"," block4i_se_excite (Multiply)   (None, 14, 14, 768)  0           ['block4i_activation[0][0]',     \n","                                                                  'block4i_se_expand[0][0]']      \n","                                                                                                  \n"," block4i_project_conv (Conv2D)  (None, 14, 14, 192)  147456      ['block4i_se_excite[0][0]']      \n","                                                                                                  \n"," block4i_project_bn (BatchNorma  (None, 14, 14, 192)  768        ['block4i_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block4i_add (Add)              (None, 14, 14, 192)  0           ['block4i_project_bn[0][0]',     \n","                                                                  'block4h_add[0][0]']            \n","                                                                                                  \n"," block4j_expand_conv (Conv2D)   (None, 14, 14, 768)  147456      ['block4i_add[0][0]']            \n","                                                                                                  \n"," block4j_expand_bn (BatchNormal  (None, 14, 14, 768)  3072       ['block4j_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block4j_expand_activation (Act  (None, 14, 14, 768)  0          ['block4j_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block4j_dwconv2 (DepthwiseConv  (None, 14, 14, 768)  6912       ['block4j_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block4j_bn (BatchNormalization  (None, 14, 14, 768)  3072       ['block4j_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block4j_activation (Activation  (None, 14, 14, 768)  0          ['block4j_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block4j_se_squeeze (GlobalAver  (None, 768)         0           ['block4j_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block4j_se_reshape (Reshape)   (None, 1, 1, 768)    0           ['block4j_se_squeeze[0][0]']     \n","                                                                                                  \n"," block4j_se_reduce (Conv2D)     (None, 1, 1, 48)     36912       ['block4j_se_reshape[0][0]']     \n","                                                                                                  \n"," block4j_se_expand (Conv2D)     (None, 1, 1, 768)    37632       ['block4j_se_reduce[0][0]']      \n","                                                                                                  \n"," block4j_se_excite (Multiply)   (None, 14, 14, 768)  0           ['block4j_activation[0][0]',     \n","                                                                  'block4j_se_expand[0][0]']      \n","                                                                                                  \n"," block4j_project_conv (Conv2D)  (None, 14, 14, 192)  147456      ['block4j_se_excite[0][0]']      \n","                                                                                                  \n"," block4j_project_bn (BatchNorma  (None, 14, 14, 192)  768        ['block4j_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block4j_add (Add)              (None, 14, 14, 192)  0           ['block4j_project_bn[0][0]',     \n","                                                                  'block4i_add[0][0]']            \n","                                                                                                  \n"," block5a_expand_conv (Conv2D)   (None, 14, 14, 1152  221184      ['block4j_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5a_expand_bn (BatchNormal  (None, 14, 14, 1152  4608       ['block5a_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5a_expand_activation (Act  (None, 14, 14, 1152  0          ['block5a_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5a_dwconv2 (DepthwiseConv  (None, 14, 14, 1152  10368      ['block5a_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5a_bn (BatchNormalization  (None, 14, 14, 1152  4608       ['block5a_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5a_activation (Activation  (None, 14, 14, 1152  0          ['block5a_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5a_se_squeeze (GlobalAver  (None, 1152)        0           ['block5a_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5a_se_reshape (Reshape)   (None, 1, 1, 1152)   0           ['block5a_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5a_se_reduce (Conv2D)     (None, 1, 1, 48)     55344       ['block5a_se_reshape[0][0]']     \n","                                                                                                  \n"," block5a_se_expand (Conv2D)     (None, 1, 1, 1152)   56448       ['block5a_se_reduce[0][0]']      \n","                                                                                                  \n"," block5a_se_excite (Multiply)   (None, 14, 14, 1152  0           ['block5a_activation[0][0]',     \n","                                )                                 'block5a_se_expand[0][0]']      \n","                                                                                                  \n"," block5a_project_conv (Conv2D)  (None, 14, 14, 224)  258048      ['block5a_se_excite[0][0]']      \n","                                                                                                  \n"," block5a_project_bn (BatchNorma  (None, 14, 14, 224)  896        ['block5a_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5b_expand_conv (Conv2D)   (None, 14, 14, 1344  301056      ['block5a_project_bn[0][0]']     \n","                                )                                                                 \n","                                                                                                  \n"," block5b_expand_bn (BatchNormal  (None, 14, 14, 1344  5376       ['block5b_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5b_expand_activation (Act  (None, 14, 14, 1344  0          ['block5b_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5b_dwconv2 (DepthwiseConv  (None, 14, 14, 1344  12096      ['block5b_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5b_bn (BatchNormalization  (None, 14, 14, 1344  5376       ['block5b_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5b_activation (Activation  (None, 14, 14, 1344  0          ['block5b_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5b_se_squeeze (GlobalAver  (None, 1344)        0           ['block5b_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5b_se_reshape (Reshape)   (None, 1, 1, 1344)   0           ['block5b_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5b_se_reduce (Conv2D)     (None, 1, 1, 56)     75320       ['block5b_se_reshape[0][0]']     \n","                                                                                                  \n"," block5b_se_expand (Conv2D)     (None, 1, 1, 1344)   76608       ['block5b_se_reduce[0][0]']      \n","                                                                                                  \n"," block5b_se_excite (Multiply)   (None, 14, 14, 1344  0           ['block5b_activation[0][0]',     \n","                                )                                 'block5b_se_expand[0][0]']      \n","                                                                                                  \n"," block5b_project_conv (Conv2D)  (None, 14, 14, 224)  301056      ['block5b_se_excite[0][0]']      \n","                                                                                                  \n"," block5b_project_bn (BatchNorma  (None, 14, 14, 224)  896        ['block5b_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5b_add (Add)              (None, 14, 14, 224)  0           ['block5b_project_bn[0][0]',     \n","                                                                  'block5a_project_bn[0][0]']     \n","                                                                                                  \n"," block5c_expand_conv (Conv2D)   (None, 14, 14, 1344  301056      ['block5b_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5c_expand_bn (BatchNormal  (None, 14, 14, 1344  5376       ['block5c_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5c_expand_activation (Act  (None, 14, 14, 1344  0          ['block5c_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5c_dwconv2 (DepthwiseConv  (None, 14, 14, 1344  12096      ['block5c_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5c_bn (BatchNormalization  (None, 14, 14, 1344  5376       ['block5c_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5c_activation (Activation  (None, 14, 14, 1344  0          ['block5c_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5c_se_squeeze (GlobalAver  (None, 1344)        0           ['block5c_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5c_se_reshape (Reshape)   (None, 1, 1, 1344)   0           ['block5c_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5c_se_reduce (Conv2D)     (None, 1, 1, 56)     75320       ['block5c_se_reshape[0][0]']     \n","                                                                                                  \n"," block5c_se_expand (Conv2D)     (None, 1, 1, 1344)   76608       ['block5c_se_reduce[0][0]']      \n","                                                                                                  \n"," block5c_se_excite (Multiply)   (None, 14, 14, 1344  0           ['block5c_activation[0][0]',     \n","                                )                                 'block5c_se_expand[0][0]']      \n","                                                                                                  \n"," block5c_project_conv (Conv2D)  (None, 14, 14, 224)  301056      ['block5c_se_excite[0][0]']      \n","                                                                                                  \n"," block5c_project_bn (BatchNorma  (None, 14, 14, 224)  896        ['block5c_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5c_add (Add)              (None, 14, 14, 224)  0           ['block5c_project_bn[0][0]',     \n","                                                                  'block5b_add[0][0]']            \n","                                                                                                  \n"," block5d_expand_conv (Conv2D)   (None, 14, 14, 1344  301056      ['block5c_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5d_expand_bn (BatchNormal  (None, 14, 14, 1344  5376       ['block5d_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5d_expand_activation (Act  (None, 14, 14, 1344  0          ['block5d_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5d_dwconv2 (DepthwiseConv  (None, 14, 14, 1344  12096      ['block5d_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5d_bn (BatchNormalization  (None, 14, 14, 1344  5376       ['block5d_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5d_activation (Activation  (None, 14, 14, 1344  0          ['block5d_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5d_se_squeeze (GlobalAver  (None, 1344)        0           ['block5d_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5d_se_reshape (Reshape)   (None, 1, 1, 1344)   0           ['block5d_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5d_se_reduce (Conv2D)     (None, 1, 1, 56)     75320       ['block5d_se_reshape[0][0]']     \n","                                                                                                  \n"," block5d_se_expand (Conv2D)     (None, 1, 1, 1344)   76608       ['block5d_se_reduce[0][0]']      \n","                                                                                                  \n"," block5d_se_excite (Multiply)   (None, 14, 14, 1344  0           ['block5d_activation[0][0]',     \n","                                )                                 'block5d_se_expand[0][0]']      \n","                                                                                                  \n"," block5d_project_conv (Conv2D)  (None, 14, 14, 224)  301056      ['block5d_se_excite[0][0]']      \n","                                                                                                  \n"," block5d_project_bn (BatchNorma  (None, 14, 14, 224)  896        ['block5d_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5d_add (Add)              (None, 14, 14, 224)  0           ['block5d_project_bn[0][0]',     \n","                                                                  'block5c_add[0][0]']            \n","                                                                                                  \n"," block5e_expand_conv (Conv2D)   (None, 14, 14, 1344  301056      ['block5d_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5e_expand_bn (BatchNormal  (None, 14, 14, 1344  5376       ['block5e_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5e_expand_activation (Act  (None, 14, 14, 1344  0          ['block5e_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5e_dwconv2 (DepthwiseConv  (None, 14, 14, 1344  12096      ['block5e_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5e_bn (BatchNormalization  (None, 14, 14, 1344  5376       ['block5e_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5e_activation (Activation  (None, 14, 14, 1344  0          ['block5e_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5e_se_squeeze (GlobalAver  (None, 1344)        0           ['block5e_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5e_se_reshape (Reshape)   (None, 1, 1, 1344)   0           ['block5e_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5e_se_reduce (Conv2D)     (None, 1, 1, 56)     75320       ['block5e_se_reshape[0][0]']     \n","                                                                                                  \n"," block5e_se_expand (Conv2D)     (None, 1, 1, 1344)   76608       ['block5e_se_reduce[0][0]']      \n","                                                                                                  \n"," block5e_se_excite (Multiply)   (None, 14, 14, 1344  0           ['block5e_activation[0][0]',     \n","                                )                                 'block5e_se_expand[0][0]']      \n","                                                                                                  \n"," block5e_project_conv (Conv2D)  (None, 14, 14, 224)  301056      ['block5e_se_excite[0][0]']      \n","                                                                                                  \n"," block5e_project_bn (BatchNorma  (None, 14, 14, 224)  896        ['block5e_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5e_add (Add)              (None, 14, 14, 224)  0           ['block5e_project_bn[0][0]',     \n","                                                                  'block5d_add[0][0]']            \n","                                                                                                  \n"," block5f_expand_conv (Conv2D)   (None, 14, 14, 1344  301056      ['block5e_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5f_expand_bn (BatchNormal  (None, 14, 14, 1344  5376       ['block5f_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5f_expand_activation (Act  (None, 14, 14, 1344  0          ['block5f_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5f_dwconv2 (DepthwiseConv  (None, 14, 14, 1344  12096      ['block5f_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5f_bn (BatchNormalization  (None, 14, 14, 1344  5376       ['block5f_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5f_activation (Activation  (None, 14, 14, 1344  0          ['block5f_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5f_se_squeeze (GlobalAver  (None, 1344)        0           ['block5f_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5f_se_reshape (Reshape)   (None, 1, 1, 1344)   0           ['block5f_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5f_se_reduce (Conv2D)     (None, 1, 1, 56)     75320       ['block5f_se_reshape[0][0]']     \n","                                                                                                  \n"," block5f_se_expand (Conv2D)     (None, 1, 1, 1344)   76608       ['block5f_se_reduce[0][0]']      \n","                                                                                                  \n"," block5f_se_excite (Multiply)   (None, 14, 14, 1344  0           ['block5f_activation[0][0]',     \n","                                )                                 'block5f_se_expand[0][0]']      \n","                                                                                                  \n"," block5f_project_conv (Conv2D)  (None, 14, 14, 224)  301056      ['block5f_se_excite[0][0]']      \n","                                                                                                  \n"," block5f_project_bn (BatchNorma  (None, 14, 14, 224)  896        ['block5f_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5f_add (Add)              (None, 14, 14, 224)  0           ['block5f_project_bn[0][0]',     \n","                                                                  'block5e_add[0][0]']            \n","                                                                                                  \n"," block5g_expand_conv (Conv2D)   (None, 14, 14, 1344  301056      ['block5f_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5g_expand_bn (BatchNormal  (None, 14, 14, 1344  5376       ['block5g_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5g_expand_activation (Act  (None, 14, 14, 1344  0          ['block5g_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5g_dwconv2 (DepthwiseConv  (None, 14, 14, 1344  12096      ['block5g_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5g_bn (BatchNormalization  (None, 14, 14, 1344  5376       ['block5g_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5g_activation (Activation  (None, 14, 14, 1344  0          ['block5g_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5g_se_squeeze (GlobalAver  (None, 1344)        0           ['block5g_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5g_se_reshape (Reshape)   (None, 1, 1, 1344)   0           ['block5g_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5g_se_reduce (Conv2D)     (None, 1, 1, 56)     75320       ['block5g_se_reshape[0][0]']     \n","                                                                                                  \n"," block5g_se_expand (Conv2D)     (None, 1, 1, 1344)   76608       ['block5g_se_reduce[0][0]']      \n","                                                                                                  \n"," block5g_se_excite (Multiply)   (None, 14, 14, 1344  0           ['block5g_activation[0][0]',     \n","                                )                                 'block5g_se_expand[0][0]']      \n","                                                                                                  \n"," block5g_project_conv (Conv2D)  (None, 14, 14, 224)  301056      ['block5g_se_excite[0][0]']      \n","                                                                                                  \n"," block5g_project_bn (BatchNorma  (None, 14, 14, 224)  896        ['block5g_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5g_add (Add)              (None, 14, 14, 224)  0           ['block5g_project_bn[0][0]',     \n","                                                                  'block5f_add[0][0]']            \n","                                                                                                  \n"," block5h_expand_conv (Conv2D)   (None, 14, 14, 1344  301056      ['block5g_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5h_expand_bn (BatchNormal  (None, 14, 14, 1344  5376       ['block5h_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5h_expand_activation (Act  (None, 14, 14, 1344  0          ['block5h_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5h_dwconv2 (DepthwiseConv  (None, 14, 14, 1344  12096      ['block5h_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5h_bn (BatchNormalization  (None, 14, 14, 1344  5376       ['block5h_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5h_activation (Activation  (None, 14, 14, 1344  0          ['block5h_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5h_se_squeeze (GlobalAver  (None, 1344)        0           ['block5h_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5h_se_reshape (Reshape)   (None, 1, 1, 1344)   0           ['block5h_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5h_se_reduce (Conv2D)     (None, 1, 1, 56)     75320       ['block5h_se_reshape[0][0]']     \n","                                                                                                  \n"," block5h_se_expand (Conv2D)     (None, 1, 1, 1344)   76608       ['block5h_se_reduce[0][0]']      \n","                                                                                                  \n"," block5h_se_excite (Multiply)   (None, 14, 14, 1344  0           ['block5h_activation[0][0]',     \n","                                )                                 'block5h_se_expand[0][0]']      \n","                                                                                                  \n"," block5h_project_conv (Conv2D)  (None, 14, 14, 224)  301056      ['block5h_se_excite[0][0]']      \n","                                                                                                  \n"," block5h_project_bn (BatchNorma  (None, 14, 14, 224)  896        ['block5h_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5h_add (Add)              (None, 14, 14, 224)  0           ['block5h_project_bn[0][0]',     \n","                                                                  'block5g_add[0][0]']            \n","                                                                                                  \n"," block5i_expand_conv (Conv2D)   (None, 14, 14, 1344  301056      ['block5h_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5i_expand_bn (BatchNormal  (None, 14, 14, 1344  5376       ['block5i_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5i_expand_activation (Act  (None, 14, 14, 1344  0          ['block5i_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5i_dwconv2 (DepthwiseConv  (None, 14, 14, 1344  12096      ['block5i_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5i_bn (BatchNormalization  (None, 14, 14, 1344  5376       ['block5i_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5i_activation (Activation  (None, 14, 14, 1344  0          ['block5i_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5i_se_squeeze (GlobalAver  (None, 1344)        0           ['block5i_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5i_se_reshape (Reshape)   (None, 1, 1, 1344)   0           ['block5i_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5i_se_reduce (Conv2D)     (None, 1, 1, 56)     75320       ['block5i_se_reshape[0][0]']     \n","                                                                                                  \n"," block5i_se_expand (Conv2D)     (None, 1, 1, 1344)   76608       ['block5i_se_reduce[0][0]']      \n","                                                                                                  \n"," block5i_se_excite (Multiply)   (None, 14, 14, 1344  0           ['block5i_activation[0][0]',     \n","                                )                                 'block5i_se_expand[0][0]']      \n","                                                                                                  \n"," block5i_project_conv (Conv2D)  (None, 14, 14, 224)  301056      ['block5i_se_excite[0][0]']      \n","                                                                                                  \n"," block5i_project_bn (BatchNorma  (None, 14, 14, 224)  896        ['block5i_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5i_add (Add)              (None, 14, 14, 224)  0           ['block5i_project_bn[0][0]',     \n","                                                                  'block5h_add[0][0]']            \n","                                                                                                  \n"," block5j_expand_conv (Conv2D)   (None, 14, 14, 1344  301056      ['block5i_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5j_expand_bn (BatchNormal  (None, 14, 14, 1344  5376       ['block5j_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5j_expand_activation (Act  (None, 14, 14, 1344  0          ['block5j_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5j_dwconv2 (DepthwiseConv  (None, 14, 14, 1344  12096      ['block5j_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5j_bn (BatchNormalization  (None, 14, 14, 1344  5376       ['block5j_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5j_activation (Activation  (None, 14, 14, 1344  0          ['block5j_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5j_se_squeeze (GlobalAver  (None, 1344)        0           ['block5j_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5j_se_reshape (Reshape)   (None, 1, 1, 1344)   0           ['block5j_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5j_se_reduce (Conv2D)     (None, 1, 1, 56)     75320       ['block5j_se_reshape[0][0]']     \n","                                                                                                  \n"," block5j_se_expand (Conv2D)     (None, 1, 1, 1344)   76608       ['block5j_se_reduce[0][0]']      \n","                                                                                                  \n"," block5j_se_excite (Multiply)   (None, 14, 14, 1344  0           ['block5j_activation[0][0]',     \n","                                )                                 'block5j_se_expand[0][0]']      \n","                                                                                                  \n"," block5j_project_conv (Conv2D)  (None, 14, 14, 224)  301056      ['block5j_se_excite[0][0]']      \n","                                                                                                  \n"," block5j_project_bn (BatchNorma  (None, 14, 14, 224)  896        ['block5j_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5j_add (Add)              (None, 14, 14, 224)  0           ['block5j_project_bn[0][0]',     \n","                                                                  'block5i_add[0][0]']            \n","                                                                                                  \n"," block5k_expand_conv (Conv2D)   (None, 14, 14, 1344  301056      ['block5j_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5k_expand_bn (BatchNormal  (None, 14, 14, 1344  5376       ['block5k_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5k_expand_activation (Act  (None, 14, 14, 1344  0          ['block5k_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5k_dwconv2 (DepthwiseConv  (None, 14, 14, 1344  12096      ['block5k_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5k_bn (BatchNormalization  (None, 14, 14, 1344  5376       ['block5k_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5k_activation (Activation  (None, 14, 14, 1344  0          ['block5k_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5k_se_squeeze (GlobalAver  (None, 1344)        0           ['block5k_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5k_se_reshape (Reshape)   (None, 1, 1, 1344)   0           ['block5k_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5k_se_reduce (Conv2D)     (None, 1, 1, 56)     75320       ['block5k_se_reshape[0][0]']     \n","                                                                                                  \n"," block5k_se_expand (Conv2D)     (None, 1, 1, 1344)   76608       ['block5k_se_reduce[0][0]']      \n","                                                                                                  \n"," block5k_se_excite (Multiply)   (None, 14, 14, 1344  0           ['block5k_activation[0][0]',     \n","                                )                                 'block5k_se_expand[0][0]']      \n","                                                                                                  \n"," block5k_project_conv (Conv2D)  (None, 14, 14, 224)  301056      ['block5k_se_excite[0][0]']      \n","                                                                                                  \n"," block5k_project_bn (BatchNorma  (None, 14, 14, 224)  896        ['block5k_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5k_add (Add)              (None, 14, 14, 224)  0           ['block5k_project_bn[0][0]',     \n","                                                                  'block5j_add[0][0]']            \n","                                                                                                  \n"," block5l_expand_conv (Conv2D)   (None, 14, 14, 1344  301056      ['block5k_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5l_expand_bn (BatchNormal  (None, 14, 14, 1344  5376       ['block5l_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5l_expand_activation (Act  (None, 14, 14, 1344  0          ['block5l_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5l_dwconv2 (DepthwiseConv  (None, 14, 14, 1344  12096      ['block5l_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5l_bn (BatchNormalization  (None, 14, 14, 1344  5376       ['block5l_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5l_activation (Activation  (None, 14, 14, 1344  0          ['block5l_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5l_se_squeeze (GlobalAver  (None, 1344)        0           ['block5l_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5l_se_reshape (Reshape)   (None, 1, 1, 1344)   0           ['block5l_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5l_se_reduce (Conv2D)     (None, 1, 1, 56)     75320       ['block5l_se_reshape[0][0]']     \n","                                                                                                  \n"," block5l_se_expand (Conv2D)     (None, 1, 1, 1344)   76608       ['block5l_se_reduce[0][0]']      \n","                                                                                                  \n"," block5l_se_excite (Multiply)   (None, 14, 14, 1344  0           ['block5l_activation[0][0]',     \n","                                )                                 'block5l_se_expand[0][0]']      \n","                                                                                                  \n"," block5l_project_conv (Conv2D)  (None, 14, 14, 224)  301056      ['block5l_se_excite[0][0]']      \n","                                                                                                  \n"," block5l_project_bn (BatchNorma  (None, 14, 14, 224)  896        ['block5l_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5l_add (Add)              (None, 14, 14, 224)  0           ['block5l_project_bn[0][0]',     \n","                                                                  'block5k_add[0][0]']            \n","                                                                                                  \n"," block5m_expand_conv (Conv2D)   (None, 14, 14, 1344  301056      ['block5l_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5m_expand_bn (BatchNormal  (None, 14, 14, 1344  5376       ['block5m_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5m_expand_activation (Act  (None, 14, 14, 1344  0          ['block5m_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5m_dwconv2 (DepthwiseConv  (None, 14, 14, 1344  12096      ['block5m_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5m_bn (BatchNormalization  (None, 14, 14, 1344  5376       ['block5m_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5m_activation (Activation  (None, 14, 14, 1344  0          ['block5m_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5m_se_squeeze (GlobalAver  (None, 1344)        0           ['block5m_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5m_se_reshape (Reshape)   (None, 1, 1, 1344)   0           ['block5m_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5m_se_reduce (Conv2D)     (None, 1, 1, 56)     75320       ['block5m_se_reshape[0][0]']     \n","                                                                                                  \n"," block5m_se_expand (Conv2D)     (None, 1, 1, 1344)   76608       ['block5m_se_reduce[0][0]']      \n","                                                                                                  \n"," block5m_se_excite (Multiply)   (None, 14, 14, 1344  0           ['block5m_activation[0][0]',     \n","                                )                                 'block5m_se_expand[0][0]']      \n","                                                                                                  \n"," block5m_project_conv (Conv2D)  (None, 14, 14, 224)  301056      ['block5m_se_excite[0][0]']      \n","                                                                                                  \n"," block5m_project_bn (BatchNorma  (None, 14, 14, 224)  896        ['block5m_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5m_add (Add)              (None, 14, 14, 224)  0           ['block5m_project_bn[0][0]',     \n","                                                                  'block5l_add[0][0]']            \n","                                                                                                  \n"," block5n_expand_conv (Conv2D)   (None, 14, 14, 1344  301056      ['block5m_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5n_expand_bn (BatchNormal  (None, 14, 14, 1344  5376       ['block5n_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5n_expand_activation (Act  (None, 14, 14, 1344  0          ['block5n_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5n_dwconv2 (DepthwiseConv  (None, 14, 14, 1344  12096      ['block5n_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5n_bn (BatchNormalization  (None, 14, 14, 1344  5376       ['block5n_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5n_activation (Activation  (None, 14, 14, 1344  0          ['block5n_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5n_se_squeeze (GlobalAver  (None, 1344)        0           ['block5n_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5n_se_reshape (Reshape)   (None, 1, 1, 1344)   0           ['block5n_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5n_se_reduce (Conv2D)     (None, 1, 1, 56)     75320       ['block5n_se_reshape[0][0]']     \n","                                                                                                  \n"," block5n_se_expand (Conv2D)     (None, 1, 1, 1344)   76608       ['block5n_se_reduce[0][0]']      \n","                                                                                                  \n"," block5n_se_excite (Multiply)   (None, 14, 14, 1344  0           ['block5n_activation[0][0]',     \n","                                )                                 'block5n_se_expand[0][0]']      \n","                                                                                                  \n"," block5n_project_conv (Conv2D)  (None, 14, 14, 224)  301056      ['block5n_se_excite[0][0]']      \n","                                                                                                  \n"," block5n_project_bn (BatchNorma  (None, 14, 14, 224)  896        ['block5n_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5n_add (Add)              (None, 14, 14, 224)  0           ['block5n_project_bn[0][0]',     \n","                                                                  'block5m_add[0][0]']            \n","                                                                                                  \n"," block5o_expand_conv (Conv2D)   (None, 14, 14, 1344  301056      ['block5n_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5o_expand_bn (BatchNormal  (None, 14, 14, 1344  5376       ['block5o_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5o_expand_activation (Act  (None, 14, 14, 1344  0          ['block5o_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5o_dwconv2 (DepthwiseConv  (None, 14, 14, 1344  12096      ['block5o_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5o_bn (BatchNormalization  (None, 14, 14, 1344  5376       ['block5o_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5o_activation (Activation  (None, 14, 14, 1344  0          ['block5o_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5o_se_squeeze (GlobalAver  (None, 1344)        0           ['block5o_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5o_se_reshape (Reshape)   (None, 1, 1, 1344)   0           ['block5o_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5o_se_reduce (Conv2D)     (None, 1, 1, 56)     75320       ['block5o_se_reshape[0][0]']     \n","                                                                                                  \n"," block5o_se_expand (Conv2D)     (None, 1, 1, 1344)   76608       ['block5o_se_reduce[0][0]']      \n","                                                                                                  \n"," block5o_se_excite (Multiply)   (None, 14, 14, 1344  0           ['block5o_activation[0][0]',     \n","                                )                                 'block5o_se_expand[0][0]']      \n","                                                                                                  \n"," block5o_project_conv (Conv2D)  (None, 14, 14, 224)  301056      ['block5o_se_excite[0][0]']      \n","                                                                                                  \n"," block5o_project_bn (BatchNorma  (None, 14, 14, 224)  896        ['block5o_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5o_add (Add)              (None, 14, 14, 224)  0           ['block5o_project_bn[0][0]',     \n","                                                                  'block5n_add[0][0]']            \n","                                                                                                  \n"," block5p_expand_conv (Conv2D)   (None, 14, 14, 1344  301056      ['block5o_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5p_expand_bn (BatchNormal  (None, 14, 14, 1344  5376       ['block5p_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5p_expand_activation (Act  (None, 14, 14, 1344  0          ['block5p_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5p_dwconv2 (DepthwiseConv  (None, 14, 14, 1344  12096      ['block5p_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5p_bn (BatchNormalization  (None, 14, 14, 1344  5376       ['block5p_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5p_activation (Activation  (None, 14, 14, 1344  0          ['block5p_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5p_se_squeeze (GlobalAver  (None, 1344)        0           ['block5p_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5p_se_reshape (Reshape)   (None, 1, 1, 1344)   0           ['block5p_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5p_se_reduce (Conv2D)     (None, 1, 1, 56)     75320       ['block5p_se_reshape[0][0]']     \n","                                                                                                  \n"," block5p_se_expand (Conv2D)     (None, 1, 1, 1344)   76608       ['block5p_se_reduce[0][0]']      \n","                                                                                                  \n"," block5p_se_excite (Multiply)   (None, 14, 14, 1344  0           ['block5p_activation[0][0]',     \n","                                )                                 'block5p_se_expand[0][0]']      \n","                                                                                                  \n"," block5p_project_conv (Conv2D)  (None, 14, 14, 224)  301056      ['block5p_se_excite[0][0]']      \n","                                                                                                  \n"," block5p_project_bn (BatchNorma  (None, 14, 14, 224)  896        ['block5p_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5p_add (Add)              (None, 14, 14, 224)  0           ['block5p_project_bn[0][0]',     \n","                                                                  'block5o_add[0][0]']            \n","                                                                                                  \n"," block5q_expand_conv (Conv2D)   (None, 14, 14, 1344  301056      ['block5p_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5q_expand_bn (BatchNormal  (None, 14, 14, 1344  5376       ['block5q_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5q_expand_activation (Act  (None, 14, 14, 1344  0          ['block5q_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5q_dwconv2 (DepthwiseConv  (None, 14, 14, 1344  12096      ['block5q_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5q_bn (BatchNormalization  (None, 14, 14, 1344  5376       ['block5q_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5q_activation (Activation  (None, 14, 14, 1344  0          ['block5q_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5q_se_squeeze (GlobalAver  (None, 1344)        0           ['block5q_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5q_se_reshape (Reshape)   (None, 1, 1, 1344)   0           ['block5q_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5q_se_reduce (Conv2D)     (None, 1, 1, 56)     75320       ['block5q_se_reshape[0][0]']     \n","                                                                                                  \n"," block5q_se_expand (Conv2D)     (None, 1, 1, 1344)   76608       ['block5q_se_reduce[0][0]']      \n","                                                                                                  \n"," block5q_se_excite (Multiply)   (None, 14, 14, 1344  0           ['block5q_activation[0][0]',     \n","                                )                                 'block5q_se_expand[0][0]']      \n","                                                                                                  \n"," block5q_project_conv (Conv2D)  (None, 14, 14, 224)  301056      ['block5q_se_excite[0][0]']      \n","                                                                                                  \n"," block5q_project_bn (BatchNorma  (None, 14, 14, 224)  896        ['block5q_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5q_add (Add)              (None, 14, 14, 224)  0           ['block5q_project_bn[0][0]',     \n","                                                                  'block5p_add[0][0]']            \n","                                                                                                  \n"," block5r_expand_conv (Conv2D)   (None, 14, 14, 1344  301056      ['block5q_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5r_expand_bn (BatchNormal  (None, 14, 14, 1344  5376       ['block5r_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5r_expand_activation (Act  (None, 14, 14, 1344  0          ['block5r_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5r_dwconv2 (DepthwiseConv  (None, 14, 14, 1344  12096      ['block5r_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5r_bn (BatchNormalization  (None, 14, 14, 1344  5376       ['block5r_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5r_activation (Activation  (None, 14, 14, 1344  0          ['block5r_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5r_se_squeeze (GlobalAver  (None, 1344)        0           ['block5r_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5r_se_reshape (Reshape)   (None, 1, 1, 1344)   0           ['block5r_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5r_se_reduce (Conv2D)     (None, 1, 1, 56)     75320       ['block5r_se_reshape[0][0]']     \n","                                                                                                  \n"," block5r_se_expand (Conv2D)     (None, 1, 1, 1344)   76608       ['block5r_se_reduce[0][0]']      \n","                                                                                                  \n"," block5r_se_excite (Multiply)   (None, 14, 14, 1344  0           ['block5r_activation[0][0]',     \n","                                )                                 'block5r_se_expand[0][0]']      \n","                                                                                                  \n"," block5r_project_conv (Conv2D)  (None, 14, 14, 224)  301056      ['block5r_se_excite[0][0]']      \n","                                                                                                  \n"," block5r_project_bn (BatchNorma  (None, 14, 14, 224)  896        ['block5r_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5r_add (Add)              (None, 14, 14, 224)  0           ['block5r_project_bn[0][0]',     \n","                                                                  'block5q_add[0][0]']            \n","                                                                                                  \n"," block5s_expand_conv (Conv2D)   (None, 14, 14, 1344  301056      ['block5r_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block5s_expand_bn (BatchNormal  (None, 14, 14, 1344  5376       ['block5s_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block5s_expand_activation (Act  (None, 14, 14, 1344  0          ['block5s_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block5s_dwconv2 (DepthwiseConv  (None, 14, 14, 1344  12096      ['block5s_expand_activation[0][0]\n"," 2D)                            )                                ']                               \n","                                                                                                  \n"," block5s_bn (BatchNormalization  (None, 14, 14, 1344  5376       ['block5s_dwconv2[0][0]']        \n"," )                              )                                                                 \n","                                                                                                  \n"," block5s_activation (Activation  (None, 14, 14, 1344  0          ['block5s_bn[0][0]']             \n"," )                              )                                                                 \n","                                                                                                  \n"," block5s_se_squeeze (GlobalAver  (None, 1344)        0           ['block5s_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block5s_se_reshape (Reshape)   (None, 1, 1, 1344)   0           ['block5s_se_squeeze[0][0]']     \n","                                                                                                  \n"," block5s_se_reduce (Conv2D)     (None, 1, 1, 56)     75320       ['block5s_se_reshape[0][0]']     \n","                                                                                                  \n"," block5s_se_expand (Conv2D)     (None, 1, 1, 1344)   76608       ['block5s_se_reduce[0][0]']      \n","                                                                                                  \n"," block5s_se_excite (Multiply)   (None, 14, 14, 1344  0           ['block5s_activation[0][0]',     \n","                                )                                 'block5s_se_expand[0][0]']      \n","                                                                                                  \n"," block5s_project_conv (Conv2D)  (None, 14, 14, 224)  301056      ['block5s_se_excite[0][0]']      \n","                                                                                                  \n"," block5s_project_bn (BatchNorma  (None, 14, 14, 224)  896        ['block5s_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block5s_add (Add)              (None, 14, 14, 224)  0           ['block5s_project_bn[0][0]',     \n","                                                                  'block5r_add[0][0]']            \n","                                                                                                  \n"," block6a_expand_conv (Conv2D)   (None, 14, 14, 1344  301056      ['block5s_add[0][0]']            \n","                                )                                                                 \n","                                                                                                  \n"," block6a_expand_bn (BatchNormal  (None, 14, 14, 1344  5376       ['block6a_expand_conv[0][0]']    \n"," ization)                       )                                                                 \n","                                                                                                  \n"," block6a_expand_activation (Act  (None, 14, 14, 1344  0          ['block6a_expand_bn[0][0]']      \n"," ivation)                       )                                                                 \n","                                                                                                  \n"," block6a_dwconv2 (DepthwiseConv  (None, 7, 7, 1344)  12096       ['block6a_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6a_bn (BatchNormalization  (None, 7, 7, 1344)  5376        ['block6a_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6a_activation (Activation  (None, 7, 7, 1344)  0           ['block6a_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6a_se_squeeze (GlobalAver  (None, 1344)        0           ['block6a_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6a_se_reshape (Reshape)   (None, 1, 1, 1344)   0           ['block6a_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6a_se_reduce (Conv2D)     (None, 1, 1, 56)     75320       ['block6a_se_reshape[0][0]']     \n","                                                                                                  \n"," block6a_se_expand (Conv2D)     (None, 1, 1, 1344)   76608       ['block6a_se_reduce[0][0]']      \n","                                                                                                  \n"," block6a_se_excite (Multiply)   (None, 7, 7, 1344)   0           ['block6a_activation[0][0]',     \n","                                                                  'block6a_se_expand[0][0]']      \n","                                                                                                  \n"," block6a_project_conv (Conv2D)  (None, 7, 7, 384)    516096      ['block6a_se_excite[0][0]']      \n","                                                                                                  \n"," block6a_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6a_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6b_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6a_project_bn[0][0]']     \n","                                                                                                  \n"," block6b_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6b_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6b_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6b_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6b_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6b_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6b_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6b_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6b_activation (Activation  (None, 7, 7, 2304)  0           ['block6b_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6b_se_squeeze (GlobalAver  (None, 2304)        0           ['block6b_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6b_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6b_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6b_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6b_se_reshape[0][0]']     \n","                                                                                                  \n"," block6b_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6b_se_reduce[0][0]']      \n","                                                                                                  \n"," block6b_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6b_activation[0][0]',     \n","                                                                  'block6b_se_expand[0][0]']      \n","                                                                                                  \n"," block6b_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6b_se_excite[0][0]']      \n","                                                                                                  \n"," block6b_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6b_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6b_add (Add)              (None, 7, 7, 384)    0           ['block6b_project_bn[0][0]',     \n","                                                                  'block6a_project_bn[0][0]']     \n","                                                                                                  \n"," block6c_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6b_add[0][0]']            \n","                                                                                                  \n"," block6c_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6c_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6c_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6c_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6c_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6c_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6c_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6c_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6c_activation (Activation  (None, 7, 7, 2304)  0           ['block6c_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6c_se_squeeze (GlobalAver  (None, 2304)        0           ['block6c_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6c_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6c_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6c_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6c_se_reshape[0][0]']     \n","                                                                                                  \n"," block6c_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6c_se_reduce[0][0]']      \n","                                                                                                  \n"," block6c_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6c_activation[0][0]',     \n","                                                                  'block6c_se_expand[0][0]']      \n","                                                                                                  \n"," block6c_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6c_se_excite[0][0]']      \n","                                                                                                  \n"," block6c_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6c_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6c_add (Add)              (None, 7, 7, 384)    0           ['block6c_project_bn[0][0]',     \n","                                                                  'block6b_add[0][0]']            \n","                                                                                                  \n"," block6d_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6c_add[0][0]']            \n","                                                                                                  \n"," block6d_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6d_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6d_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6d_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6d_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6d_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6d_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6d_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6d_activation (Activation  (None, 7, 7, 2304)  0           ['block6d_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6d_se_squeeze (GlobalAver  (None, 2304)        0           ['block6d_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6d_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6d_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6d_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6d_se_reshape[0][0]']     \n","                                                                                                  \n"," block6d_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6d_se_reduce[0][0]']      \n","                                                                                                  \n"," block6d_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6d_activation[0][0]',     \n","                                                                  'block6d_se_expand[0][0]']      \n","                                                                                                  \n"," block6d_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6d_se_excite[0][0]']      \n","                                                                                                  \n"," block6d_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6d_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6d_add (Add)              (None, 7, 7, 384)    0           ['block6d_project_bn[0][0]',     \n","                                                                  'block6c_add[0][0]']            \n","                                                                                                  \n"," block6e_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6d_add[0][0]']            \n","                                                                                                  \n"," block6e_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6e_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6e_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6e_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6e_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6e_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6e_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6e_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6e_activation (Activation  (None, 7, 7, 2304)  0           ['block6e_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6e_se_squeeze (GlobalAver  (None, 2304)        0           ['block6e_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6e_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6e_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6e_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6e_se_reshape[0][0]']     \n","                                                                                                  \n"," block6e_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6e_se_reduce[0][0]']      \n","                                                                                                  \n"," block6e_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6e_activation[0][0]',     \n","                                                                  'block6e_se_expand[0][0]']      \n","                                                                                                  \n"," block6e_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6e_se_excite[0][0]']      \n","                                                                                                  \n"," block6e_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6e_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6e_add (Add)              (None, 7, 7, 384)    0           ['block6e_project_bn[0][0]',     \n","                                                                  'block6d_add[0][0]']            \n","                                                                                                  \n"," block6f_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6e_add[0][0]']            \n","                                                                                                  \n"," block6f_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6f_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6f_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6f_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6f_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6f_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6f_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6f_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6f_activation (Activation  (None, 7, 7, 2304)  0           ['block6f_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6f_se_squeeze (GlobalAver  (None, 2304)        0           ['block6f_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6f_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6f_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6f_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6f_se_reshape[0][0]']     \n","                                                                                                  \n"," block6f_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6f_se_reduce[0][0]']      \n","                                                                                                  \n"," block6f_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6f_activation[0][0]',     \n","                                                                  'block6f_se_expand[0][0]']      \n","                                                                                                  \n"," block6f_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6f_se_excite[0][0]']      \n","                                                                                                  \n"," block6f_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6f_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6f_add (Add)              (None, 7, 7, 384)    0           ['block6f_project_bn[0][0]',     \n","                                                                  'block6e_add[0][0]']            \n","                                                                                                  \n"," block6g_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6f_add[0][0]']            \n","                                                                                                  \n"," block6g_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6g_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6g_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6g_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6g_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6g_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6g_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6g_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6g_activation (Activation  (None, 7, 7, 2304)  0           ['block6g_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6g_se_squeeze (GlobalAver  (None, 2304)        0           ['block6g_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6g_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6g_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6g_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6g_se_reshape[0][0]']     \n","                                                                                                  \n"," block6g_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6g_se_reduce[0][0]']      \n","                                                                                                  \n"," block6g_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6g_activation[0][0]',     \n","                                                                  'block6g_se_expand[0][0]']      \n","                                                                                                  \n"," block6g_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6g_se_excite[0][0]']      \n","                                                                                                  \n"," block6g_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6g_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6g_add (Add)              (None, 7, 7, 384)    0           ['block6g_project_bn[0][0]',     \n","                                                                  'block6f_add[0][0]']            \n","                                                                                                  \n"," block6h_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6g_add[0][0]']            \n","                                                                                                  \n"," block6h_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6h_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6h_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6h_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6h_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6h_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6h_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6h_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6h_activation (Activation  (None, 7, 7, 2304)  0           ['block6h_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6h_se_squeeze (GlobalAver  (None, 2304)        0           ['block6h_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6h_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6h_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6h_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6h_se_reshape[0][0]']     \n","                                                                                                  \n"," block6h_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6h_se_reduce[0][0]']      \n","                                                                                                  \n"," block6h_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6h_activation[0][0]',     \n","                                                                  'block6h_se_expand[0][0]']      \n","                                                                                                  \n"," block6h_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6h_se_excite[0][0]']      \n","                                                                                                  \n"," block6h_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6h_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6h_add (Add)              (None, 7, 7, 384)    0           ['block6h_project_bn[0][0]',     \n","                                                                  'block6g_add[0][0]']            \n","                                                                                                  \n"," block6i_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6h_add[0][0]']            \n","                                                                                                  \n"," block6i_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6i_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6i_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6i_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6i_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6i_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6i_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6i_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6i_activation (Activation  (None, 7, 7, 2304)  0           ['block6i_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6i_se_squeeze (GlobalAver  (None, 2304)        0           ['block6i_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6i_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6i_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6i_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6i_se_reshape[0][0]']     \n","                                                                                                  \n"," block6i_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6i_se_reduce[0][0]']      \n","                                                                                                  \n"," block6i_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6i_activation[0][0]',     \n","                                                                  'block6i_se_expand[0][0]']      \n","                                                                                                  \n"," block6i_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6i_se_excite[0][0]']      \n","                                                                                                  \n"," block6i_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6i_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6i_add (Add)              (None, 7, 7, 384)    0           ['block6i_project_bn[0][0]',     \n","                                                                  'block6h_add[0][0]']            \n","                                                                                                  \n"," block6j_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6i_add[0][0]']            \n","                                                                                                  \n"," block6j_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6j_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6j_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6j_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6j_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6j_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6j_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6j_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6j_activation (Activation  (None, 7, 7, 2304)  0           ['block6j_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6j_se_squeeze (GlobalAver  (None, 2304)        0           ['block6j_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6j_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6j_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6j_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6j_se_reshape[0][0]']     \n","                                                                                                  \n"," block6j_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6j_se_reduce[0][0]']      \n","                                                                                                  \n"," block6j_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6j_activation[0][0]',     \n","                                                                  'block6j_se_expand[0][0]']      \n","                                                                                                  \n"," block6j_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6j_se_excite[0][0]']      \n","                                                                                                  \n"," block6j_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6j_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6j_add (Add)              (None, 7, 7, 384)    0           ['block6j_project_bn[0][0]',     \n","                                                                  'block6i_add[0][0]']            \n","                                                                                                  \n"," block6k_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6j_add[0][0]']            \n","                                                                                                  \n"," block6k_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6k_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6k_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6k_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6k_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6k_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6k_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6k_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6k_activation (Activation  (None, 7, 7, 2304)  0           ['block6k_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6k_se_squeeze (GlobalAver  (None, 2304)        0           ['block6k_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6k_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6k_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6k_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6k_se_reshape[0][0]']     \n","                                                                                                  \n"," block6k_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6k_se_reduce[0][0]']      \n","                                                                                                  \n"," block6k_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6k_activation[0][0]',     \n","                                                                  'block6k_se_expand[0][0]']      \n","                                                                                                  \n"," block6k_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6k_se_excite[0][0]']      \n","                                                                                                  \n"," block6k_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6k_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6k_add (Add)              (None, 7, 7, 384)    0           ['block6k_project_bn[0][0]',     \n","                                                                  'block6j_add[0][0]']            \n","                                                                                                  \n"," block6l_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6k_add[0][0]']            \n","                                                                                                  \n"," block6l_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6l_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6l_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6l_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6l_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6l_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6l_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6l_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6l_activation (Activation  (None, 7, 7, 2304)  0           ['block6l_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6l_se_squeeze (GlobalAver  (None, 2304)        0           ['block6l_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6l_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6l_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6l_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6l_se_reshape[0][0]']     \n","                                                                                                  \n"," block6l_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6l_se_reduce[0][0]']      \n","                                                                                                  \n"," block6l_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6l_activation[0][0]',     \n","                                                                  'block6l_se_expand[0][0]']      \n","                                                                                                  \n"," block6l_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6l_se_excite[0][0]']      \n","                                                                                                  \n"," block6l_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6l_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6l_add (Add)              (None, 7, 7, 384)    0           ['block6l_project_bn[0][0]',     \n","                                                                  'block6k_add[0][0]']            \n","                                                                                                  \n"," block6m_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6l_add[0][0]']            \n","                                                                                                  \n"," block6m_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6m_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6m_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6m_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6m_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6m_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6m_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6m_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6m_activation (Activation  (None, 7, 7, 2304)  0           ['block6m_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6m_se_squeeze (GlobalAver  (None, 2304)        0           ['block6m_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6m_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6m_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6m_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6m_se_reshape[0][0]']     \n","                                                                                                  \n"," block6m_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6m_se_reduce[0][0]']      \n","                                                                                                  \n"," block6m_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6m_activation[0][0]',     \n","                                                                  'block6m_se_expand[0][0]']      \n","                                                                                                  \n"," block6m_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6m_se_excite[0][0]']      \n","                                                                                                  \n"," block6m_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6m_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6m_add (Add)              (None, 7, 7, 384)    0           ['block6m_project_bn[0][0]',     \n","                                                                  'block6l_add[0][0]']            \n","                                                                                                  \n"," block6n_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6m_add[0][0]']            \n","                                                                                                  \n"," block6n_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6n_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6n_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6n_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6n_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6n_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6n_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6n_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6n_activation (Activation  (None, 7, 7, 2304)  0           ['block6n_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6n_se_squeeze (GlobalAver  (None, 2304)        0           ['block6n_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6n_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6n_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6n_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6n_se_reshape[0][0]']     \n","                                                                                                  \n"," block6n_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6n_se_reduce[0][0]']      \n","                                                                                                  \n"," block6n_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6n_activation[0][0]',     \n","                                                                  'block6n_se_expand[0][0]']      \n","                                                                                                  \n"," block6n_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6n_se_excite[0][0]']      \n","                                                                                                  \n"," block6n_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6n_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6n_add (Add)              (None, 7, 7, 384)    0           ['block6n_project_bn[0][0]',     \n","                                                                  'block6m_add[0][0]']            \n","                                                                                                  \n"," block6o_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6n_add[0][0]']            \n","                                                                                                  \n"," block6o_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6o_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6o_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6o_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6o_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6o_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6o_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6o_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6o_activation (Activation  (None, 7, 7, 2304)  0           ['block6o_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6o_se_squeeze (GlobalAver  (None, 2304)        0           ['block6o_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6o_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6o_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6o_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6o_se_reshape[0][0]']     \n","                                                                                                  \n"," block6o_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6o_se_reduce[0][0]']      \n","                                                                                                  \n"," block6o_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6o_activation[0][0]',     \n","                                                                  'block6o_se_expand[0][0]']      \n","                                                                                                  \n"," block6o_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6o_se_excite[0][0]']      \n","                                                                                                  \n"," block6o_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6o_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6o_add (Add)              (None, 7, 7, 384)    0           ['block6o_project_bn[0][0]',     \n","                                                                  'block6n_add[0][0]']            \n","                                                                                                  \n"," block6p_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6o_add[0][0]']            \n","                                                                                                  \n"," block6p_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6p_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6p_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6p_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6p_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6p_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6p_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6p_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6p_activation (Activation  (None, 7, 7, 2304)  0           ['block6p_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6p_se_squeeze (GlobalAver  (None, 2304)        0           ['block6p_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6p_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6p_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6p_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6p_se_reshape[0][0]']     \n","                                                                                                  \n"," block6p_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6p_se_reduce[0][0]']      \n","                                                                                                  \n"," block6p_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6p_activation[0][0]',     \n","                                                                  'block6p_se_expand[0][0]']      \n","                                                                                                  \n"," block6p_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6p_se_excite[0][0]']      \n","                                                                                                  \n"," block6p_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6p_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6p_add (Add)              (None, 7, 7, 384)    0           ['block6p_project_bn[0][0]',     \n","                                                                  'block6o_add[0][0]']            \n","                                                                                                  \n"," block6q_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6p_add[0][0]']            \n","                                                                                                  \n"," block6q_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6q_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6q_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6q_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6q_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6q_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6q_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6q_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6q_activation (Activation  (None, 7, 7, 2304)  0           ['block6q_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6q_se_squeeze (GlobalAver  (None, 2304)        0           ['block6q_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6q_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6q_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6q_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6q_se_reshape[0][0]']     \n","                                                                                                  \n"," block6q_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6q_se_reduce[0][0]']      \n","                                                                                                  \n"," block6q_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6q_activation[0][0]',     \n","                                                                  'block6q_se_expand[0][0]']      \n","                                                                                                  \n"," block6q_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6q_se_excite[0][0]']      \n","                                                                                                  \n"," block6q_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6q_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6q_add (Add)              (None, 7, 7, 384)    0           ['block6q_project_bn[0][0]',     \n","                                                                  'block6p_add[0][0]']            \n","                                                                                                  \n"," block6r_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6q_add[0][0]']            \n","                                                                                                  \n"," block6r_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6r_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6r_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6r_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6r_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6r_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6r_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6r_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6r_activation (Activation  (None, 7, 7, 2304)  0           ['block6r_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6r_se_squeeze (GlobalAver  (None, 2304)        0           ['block6r_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6r_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6r_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6r_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6r_se_reshape[0][0]']     \n","                                                                                                  \n"," block6r_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6r_se_reduce[0][0]']      \n","                                                                                                  \n"," block6r_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6r_activation[0][0]',     \n","                                                                  'block6r_se_expand[0][0]']      \n","                                                                                                  \n"," block6r_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6r_se_excite[0][0]']      \n","                                                                                                  \n"," block6r_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6r_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6r_add (Add)              (None, 7, 7, 384)    0           ['block6r_project_bn[0][0]',     \n","                                                                  'block6q_add[0][0]']            \n","                                                                                                  \n"," block6s_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6r_add[0][0]']            \n","                                                                                                  \n"," block6s_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6s_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6s_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6s_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6s_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6s_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6s_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6s_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6s_activation (Activation  (None, 7, 7, 2304)  0           ['block6s_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6s_se_squeeze (GlobalAver  (None, 2304)        0           ['block6s_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6s_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6s_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6s_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6s_se_reshape[0][0]']     \n","                                                                                                  \n"," block6s_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6s_se_reduce[0][0]']      \n","                                                                                                  \n"," block6s_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6s_activation[0][0]',     \n","                                                                  'block6s_se_expand[0][0]']      \n","                                                                                                  \n"," block6s_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6s_se_excite[0][0]']      \n","                                                                                                  \n"," block6s_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6s_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6s_add (Add)              (None, 7, 7, 384)    0           ['block6s_project_bn[0][0]',     \n","                                                                  'block6r_add[0][0]']            \n","                                                                                                  \n"," block6t_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6s_add[0][0]']            \n","                                                                                                  \n"," block6t_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6t_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6t_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6t_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6t_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6t_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6t_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6t_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6t_activation (Activation  (None, 7, 7, 2304)  0           ['block6t_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6t_se_squeeze (GlobalAver  (None, 2304)        0           ['block6t_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6t_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6t_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6t_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6t_se_reshape[0][0]']     \n","                                                                                                  \n"," block6t_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6t_se_reduce[0][0]']      \n","                                                                                                  \n"," block6t_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6t_activation[0][0]',     \n","                                                                  'block6t_se_expand[0][0]']      \n","                                                                                                  \n"," block6t_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6t_se_excite[0][0]']      \n","                                                                                                  \n"," block6t_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6t_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6t_add (Add)              (None, 7, 7, 384)    0           ['block6t_project_bn[0][0]',     \n","                                                                  'block6s_add[0][0]']            \n","                                                                                                  \n"," block6u_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6t_add[0][0]']            \n","                                                                                                  \n"," block6u_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6u_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6u_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6u_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6u_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6u_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6u_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6u_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6u_activation (Activation  (None, 7, 7, 2304)  0           ['block6u_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6u_se_squeeze (GlobalAver  (None, 2304)        0           ['block6u_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6u_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6u_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6u_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6u_se_reshape[0][0]']     \n","                                                                                                  \n"," block6u_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6u_se_reduce[0][0]']      \n","                                                                                                  \n"," block6u_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6u_activation[0][0]',     \n","                                                                  'block6u_se_expand[0][0]']      \n","                                                                                                  \n"," block6u_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6u_se_excite[0][0]']      \n","                                                                                                  \n"," block6u_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6u_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6u_add (Add)              (None, 7, 7, 384)    0           ['block6u_project_bn[0][0]',     \n","                                                                  'block6t_add[0][0]']            \n","                                                                                                  \n"," block6v_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6u_add[0][0]']            \n","                                                                                                  \n"," block6v_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6v_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6v_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6v_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6v_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6v_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6v_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6v_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6v_activation (Activation  (None, 7, 7, 2304)  0           ['block6v_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6v_se_squeeze (GlobalAver  (None, 2304)        0           ['block6v_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6v_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6v_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6v_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6v_se_reshape[0][0]']     \n","                                                                                                  \n"," block6v_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6v_se_reduce[0][0]']      \n","                                                                                                  \n"," block6v_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6v_activation[0][0]',     \n","                                                                  'block6v_se_expand[0][0]']      \n","                                                                                                  \n"," block6v_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6v_se_excite[0][0]']      \n","                                                                                                  \n"," block6v_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6v_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6v_add (Add)              (None, 7, 7, 384)    0           ['block6v_project_bn[0][0]',     \n","                                                                  'block6u_add[0][0]']            \n","                                                                                                  \n"," block6w_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6v_add[0][0]']            \n","                                                                                                  \n"," block6w_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6w_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6w_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6w_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6w_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6w_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6w_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6w_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6w_activation (Activation  (None, 7, 7, 2304)  0           ['block6w_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6w_se_squeeze (GlobalAver  (None, 2304)        0           ['block6w_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6w_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6w_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6w_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6w_se_reshape[0][0]']     \n","                                                                                                  \n"," block6w_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6w_se_reduce[0][0]']      \n","                                                                                                  \n"," block6w_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6w_activation[0][0]',     \n","                                                                  'block6w_se_expand[0][0]']      \n","                                                                                                  \n"," block6w_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6w_se_excite[0][0]']      \n","                                                                                                  \n"," block6w_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6w_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6w_add (Add)              (None, 7, 7, 384)    0           ['block6w_project_bn[0][0]',     \n","                                                                  'block6v_add[0][0]']            \n","                                                                                                  \n"," block6x_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6w_add[0][0]']            \n","                                                                                                  \n"," block6x_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6x_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6x_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6x_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6x_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6x_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6x_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6x_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6x_activation (Activation  (None, 7, 7, 2304)  0           ['block6x_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6x_se_squeeze (GlobalAver  (None, 2304)        0           ['block6x_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6x_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6x_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6x_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6x_se_reshape[0][0]']     \n","                                                                                                  \n"," block6x_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6x_se_reduce[0][0]']      \n","                                                                                                  \n"," block6x_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6x_activation[0][0]',     \n","                                                                  'block6x_se_expand[0][0]']      \n","                                                                                                  \n"," block6x_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6x_se_excite[0][0]']      \n","                                                                                                  \n"," block6x_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6x_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6x_add (Add)              (None, 7, 7, 384)    0           ['block6x_project_bn[0][0]',     \n","                                                                  'block6w_add[0][0]']            \n","                                                                                                  \n"," block6y_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6x_add[0][0]']            \n","                                                                                                  \n"," block6y_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block6y_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block6y_expand_activation (Act  (None, 7, 7, 2304)  0           ['block6y_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block6y_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block6y_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block6y_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block6y_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block6y_activation (Activation  (None, 7, 7, 2304)  0           ['block6y_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block6y_se_squeeze (GlobalAver  (None, 2304)        0           ['block6y_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block6y_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block6y_se_squeeze[0][0]']     \n","                                                                                                  \n"," block6y_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block6y_se_reshape[0][0]']     \n","                                                                                                  \n"," block6y_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block6y_se_reduce[0][0]']      \n","                                                                                                  \n"," block6y_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block6y_activation[0][0]',     \n","                                                                  'block6y_se_expand[0][0]']      \n","                                                                                                  \n"," block6y_project_conv (Conv2D)  (None, 7, 7, 384)    884736      ['block6y_se_excite[0][0]']      \n","                                                                                                  \n"," block6y_project_bn (BatchNorma  (None, 7, 7, 384)   1536        ['block6y_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block6y_add (Add)              (None, 7, 7, 384)    0           ['block6y_project_bn[0][0]',     \n","                                                                  'block6x_add[0][0]']            \n","                                                                                                  \n"," block7a_expand_conv (Conv2D)   (None, 7, 7, 2304)   884736      ['block6y_add[0][0]']            \n","                                                                                                  \n"," block7a_expand_bn (BatchNormal  (None, 7, 7, 2304)  9216        ['block7a_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block7a_expand_activation (Act  (None, 7, 7, 2304)  0           ['block7a_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block7a_dwconv2 (DepthwiseConv  (None, 7, 7, 2304)  20736       ['block7a_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block7a_bn (BatchNormalization  (None, 7, 7, 2304)  9216        ['block7a_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block7a_activation (Activation  (None, 7, 7, 2304)  0           ['block7a_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block7a_se_squeeze (GlobalAver  (None, 2304)        0           ['block7a_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block7a_se_reshape (Reshape)   (None, 1, 1, 2304)   0           ['block7a_se_squeeze[0][0]']     \n","                                                                                                  \n"," block7a_se_reduce (Conv2D)     (None, 1, 1, 96)     221280      ['block7a_se_reshape[0][0]']     \n","                                                                                                  \n"," block7a_se_expand (Conv2D)     (None, 1, 1, 2304)   223488      ['block7a_se_reduce[0][0]']      \n","                                                                                                  \n"," block7a_se_excite (Multiply)   (None, 7, 7, 2304)   0           ['block7a_activation[0][0]',     \n","                                                                  'block7a_se_expand[0][0]']      \n","                                                                                                  \n"," block7a_project_conv (Conv2D)  (None, 7, 7, 640)    1474560     ['block7a_se_excite[0][0]']      \n","                                                                                                  \n"," block7a_project_bn (BatchNorma  (None, 7, 7, 640)   2560        ['block7a_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block7b_expand_conv (Conv2D)   (None, 7, 7, 3840)   2457600     ['block7a_project_bn[0][0]']     \n","                                                                                                  \n"," block7b_expand_bn (BatchNormal  (None, 7, 7, 3840)  15360       ['block7b_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block7b_expand_activation (Act  (None, 7, 7, 3840)  0           ['block7b_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block7b_dwconv2 (DepthwiseConv  (None, 7, 7, 3840)  34560       ['block7b_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block7b_bn (BatchNormalization  (None, 7, 7, 3840)  15360       ['block7b_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block7b_activation (Activation  (None, 7, 7, 3840)  0           ['block7b_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block7b_se_squeeze (GlobalAver  (None, 3840)        0           ['block7b_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block7b_se_reshape (Reshape)   (None, 1, 1, 3840)   0           ['block7b_se_squeeze[0][0]']     \n","                                                                                                  \n"," block7b_se_reduce (Conv2D)     (None, 1, 1, 160)    614560      ['block7b_se_reshape[0][0]']     \n","                                                                                                  \n"," block7b_se_expand (Conv2D)     (None, 1, 1, 3840)   618240      ['block7b_se_reduce[0][0]']      \n","                                                                                                  \n"," block7b_se_excite (Multiply)   (None, 7, 7, 3840)   0           ['block7b_activation[0][0]',     \n","                                                                  'block7b_se_expand[0][0]']      \n","                                                                                                  \n"," block7b_project_conv (Conv2D)  (None, 7, 7, 640)    2457600     ['block7b_se_excite[0][0]']      \n","                                                                                                  \n"," block7b_project_bn (BatchNorma  (None, 7, 7, 640)   2560        ['block7b_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block7b_add (Add)              (None, 7, 7, 640)    0           ['block7b_project_bn[0][0]',     \n","                                                                  'block7a_project_bn[0][0]']     \n","                                                                                                  \n"," block7c_expand_conv (Conv2D)   (None, 7, 7, 3840)   2457600     ['block7b_add[0][0]']            \n","                                                                                                  \n"," block7c_expand_bn (BatchNormal  (None, 7, 7, 3840)  15360       ['block7c_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block7c_expand_activation (Act  (None, 7, 7, 3840)  0           ['block7c_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block7c_dwconv2 (DepthwiseConv  (None, 7, 7, 3840)  34560       ['block7c_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block7c_bn (BatchNormalization  (None, 7, 7, 3840)  15360       ['block7c_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block7c_activation (Activation  (None, 7, 7, 3840)  0           ['block7c_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block7c_se_squeeze (GlobalAver  (None, 3840)        0           ['block7c_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block7c_se_reshape (Reshape)   (None, 1, 1, 3840)   0           ['block7c_se_squeeze[0][0]']     \n","                                                                                                  \n"," block7c_se_reduce (Conv2D)     (None, 1, 1, 160)    614560      ['block7c_se_reshape[0][0]']     \n","                                                                                                  \n"," block7c_se_expand (Conv2D)     (None, 1, 1, 3840)   618240      ['block7c_se_reduce[0][0]']      \n","                                                                                                  \n"," block7c_se_excite (Multiply)   (None, 7, 7, 3840)   0           ['block7c_activation[0][0]',     \n","                                                                  'block7c_se_expand[0][0]']      \n","                                                                                                  \n"," block7c_project_conv (Conv2D)  (None, 7, 7, 640)    2457600     ['block7c_se_excite[0][0]']      \n","                                                                                                  \n"," block7c_project_bn (BatchNorma  (None, 7, 7, 640)   2560        ['block7c_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block7c_add (Add)              (None, 7, 7, 640)    0           ['block7c_project_bn[0][0]',     \n","                                                                  'block7b_add[0][0]']            \n","                                                                                                  \n"," block7d_expand_conv (Conv2D)   (None, 7, 7, 3840)   2457600     ['block7c_add[0][0]']            \n","                                                                                                  \n"," block7d_expand_bn (BatchNormal  (None, 7, 7, 3840)  15360       ['block7d_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block7d_expand_activation (Act  (None, 7, 7, 3840)  0           ['block7d_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block7d_dwconv2 (DepthwiseConv  (None, 7, 7, 3840)  34560       ['block7d_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block7d_bn (BatchNormalization  (None, 7, 7, 3840)  15360       ['block7d_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block7d_activation (Activation  (None, 7, 7, 3840)  0           ['block7d_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block7d_se_squeeze (GlobalAver  (None, 3840)        0           ['block7d_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block7d_se_reshape (Reshape)   (None, 1, 1, 3840)   0           ['block7d_se_squeeze[0][0]']     \n","                                                                                                  \n"," block7d_se_reduce (Conv2D)     (None, 1, 1, 160)    614560      ['block7d_se_reshape[0][0]']     \n","                                                                                                  \n"," block7d_se_expand (Conv2D)     (None, 1, 1, 3840)   618240      ['block7d_se_reduce[0][0]']      \n","                                                                                                  \n"," block7d_se_excite (Multiply)   (None, 7, 7, 3840)   0           ['block7d_activation[0][0]',     \n","                                                                  'block7d_se_expand[0][0]']      \n","                                                                                                  \n"," block7d_project_conv (Conv2D)  (None, 7, 7, 640)    2457600     ['block7d_se_excite[0][0]']      \n","                                                                                                  \n"," block7d_project_bn (BatchNorma  (None, 7, 7, 640)   2560        ['block7d_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block7d_add (Add)              (None, 7, 7, 640)    0           ['block7d_project_bn[0][0]',     \n","                                                                  'block7c_add[0][0]']            \n","                                                                                                  \n"," block7e_expand_conv (Conv2D)   (None, 7, 7, 3840)   2457600     ['block7d_add[0][0]']            \n","                                                                                                  \n"," block7e_expand_bn (BatchNormal  (None, 7, 7, 3840)  15360       ['block7e_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block7e_expand_activation (Act  (None, 7, 7, 3840)  0           ['block7e_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block7e_dwconv2 (DepthwiseConv  (None, 7, 7, 3840)  34560       ['block7e_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block7e_bn (BatchNormalization  (None, 7, 7, 3840)  15360       ['block7e_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block7e_activation (Activation  (None, 7, 7, 3840)  0           ['block7e_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block7e_se_squeeze (GlobalAver  (None, 3840)        0           ['block7e_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block7e_se_reshape (Reshape)   (None, 1, 1, 3840)   0           ['block7e_se_squeeze[0][0]']     \n","                                                                                                  \n"," block7e_se_reduce (Conv2D)     (None, 1, 1, 160)    614560      ['block7e_se_reshape[0][0]']     \n","                                                                                                  \n"," block7e_se_expand (Conv2D)     (None, 1, 1, 3840)   618240      ['block7e_se_reduce[0][0]']      \n","                                                                                                  \n"," block7e_se_excite (Multiply)   (None, 7, 7, 3840)   0           ['block7e_activation[0][0]',     \n","                                                                  'block7e_se_expand[0][0]']      \n","                                                                                                  \n"," block7e_project_conv (Conv2D)  (None, 7, 7, 640)    2457600     ['block7e_se_excite[0][0]']      \n","                                                                                                  \n"," block7e_project_bn (BatchNorma  (None, 7, 7, 640)   2560        ['block7e_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block7e_add (Add)              (None, 7, 7, 640)    0           ['block7e_project_bn[0][0]',     \n","                                                                  'block7d_add[0][0]']            \n","                                                                                                  \n"," block7f_expand_conv (Conv2D)   (None, 7, 7, 3840)   2457600     ['block7e_add[0][0]']            \n","                                                                                                  \n"," block7f_expand_bn (BatchNormal  (None, 7, 7, 3840)  15360       ['block7f_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block7f_expand_activation (Act  (None, 7, 7, 3840)  0           ['block7f_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block7f_dwconv2 (DepthwiseConv  (None, 7, 7, 3840)  34560       ['block7f_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block7f_bn (BatchNormalization  (None, 7, 7, 3840)  15360       ['block7f_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block7f_activation (Activation  (None, 7, 7, 3840)  0           ['block7f_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block7f_se_squeeze (GlobalAver  (None, 3840)        0           ['block7f_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block7f_se_reshape (Reshape)   (None, 1, 1, 3840)   0           ['block7f_se_squeeze[0][0]']     \n","                                                                                                  \n"," block7f_se_reduce (Conv2D)     (None, 1, 1, 160)    614560      ['block7f_se_reshape[0][0]']     \n","                                                                                                  \n"," block7f_se_expand (Conv2D)     (None, 1, 1, 3840)   618240      ['block7f_se_reduce[0][0]']      \n","                                                                                                  \n"," block7f_se_excite (Multiply)   (None, 7, 7, 3840)   0           ['block7f_activation[0][0]',     \n","                                                                  'block7f_se_expand[0][0]']      \n","                                                                                                  \n"," block7f_project_conv (Conv2D)  (None, 7, 7, 640)    2457600     ['block7f_se_excite[0][0]']      \n","                                                                                                  \n"," block7f_project_bn (BatchNorma  (None, 7, 7, 640)   2560        ['block7f_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block7f_add (Add)              (None, 7, 7, 640)    0           ['block7f_project_bn[0][0]',     \n","                                                                  'block7e_add[0][0]']            \n","                                                                                                  \n"," block7g_expand_conv (Conv2D)   (None, 7, 7, 3840)   2457600     ['block7f_add[0][0]']            \n","                                                                                                  \n"," block7g_expand_bn (BatchNormal  (None, 7, 7, 3840)  15360       ['block7g_expand_conv[0][0]']    \n"," ization)                                                                                         \n","                                                                                                  \n"," block7g_expand_activation (Act  (None, 7, 7, 3840)  0           ['block7g_expand_bn[0][0]']      \n"," ivation)                                                                                         \n","                                                                                                  \n"," block7g_dwconv2 (DepthwiseConv  (None, 7, 7, 3840)  34560       ['block7g_expand_activation[0][0]\n"," 2D)                                                             ']                               \n","                                                                                                  \n"," block7g_bn (BatchNormalization  (None, 7, 7, 3840)  15360       ['block7g_dwconv2[0][0]']        \n"," )                                                                                                \n","                                                                                                  \n"," block7g_activation (Activation  (None, 7, 7, 3840)  0           ['block7g_bn[0][0]']             \n"," )                                                                                                \n","                                                                                                  \n"," block7g_se_squeeze (GlobalAver  (None, 3840)        0           ['block7g_activation[0][0]']     \n"," agePooling2D)                                                                                    \n","                                                                                                  \n"," block7g_se_reshape (Reshape)   (None, 1, 1, 3840)   0           ['block7g_se_squeeze[0][0]']     \n","                                                                                                  \n"," block7g_se_reduce (Conv2D)     (None, 1, 1, 160)    614560      ['block7g_se_reshape[0][0]']     \n","                                                                                                  \n"," block7g_se_expand (Conv2D)     (None, 1, 1, 3840)   618240      ['block7g_se_reduce[0][0]']      \n","                                                                                                  \n"," block7g_se_excite (Multiply)   (None, 7, 7, 3840)   0           ['block7g_activation[0][0]',     \n","                                                                  'block7g_se_expand[0][0]']      \n","                                                                                                  \n"," block7g_project_conv (Conv2D)  (None, 7, 7, 640)    2457600     ['block7g_se_excite[0][0]']      \n","                                                                                                  \n"," block7g_project_bn (BatchNorma  (None, 7, 7, 640)   2560        ['block7g_project_conv[0][0]']   \n"," lization)                                                                                        \n","                                                                                                  \n"," block7g_add (Add)              (None, 7, 7, 640)    0           ['block7g_project_bn[0][0]',     \n","                                                                  'block7f_add[0][0]']            \n","                                                                                                  \n"," top_conv (Conv2D)              (None, 7, 7, 1280)   819200      ['block7g_add[0][0]']            \n","                                                                                                  \n"," top_bn (BatchNormalization)    (None, 7, 7, 1280)   5120        ['top_conv[0][0]']               \n","                                                                                                  \n"," top_activation (Activation)    (None, 7, 7, 1280)   0           ['top_bn[0][0]']                 \n","                                                                                                  \n","==================================================================================================\n","Total params: 117,746,848\n","Trainable params: 117,234,272\n","Non-trainable params: 512,576\n","__________________________________________________________________________________________________\n"]}]},{"cell_type":"code","source":["model = models.Sequential()\n","model.add(conv_base)\n","model.add(layers.Flatten())\n","model.add(layers.Dense(1024, activation='relu'))\n","model.add(layers.Dropout(0.5))\n","model.add(layers.Dense(15, activation='softmax'))"],"metadata":{"id":"ehM_1OsIvgvK"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["model.summary()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"sPm5bn6EvuWr","executionInfo":{"status":"ok","timestamp":1649934457024,"user_tz":-300,"elapsed":49,"user":{"displayName":"Даниил Маненок","userId":"11391168364756720378"}},"outputId":"547ec849-6ec7-498c-a6aa-784868437752"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Model: \"sequential_7\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," efficientnetv2-l (Functiona  (None, 7, 7, 1280)       117746848 \n"," l)                                                              \n","                                                                 \n"," flatten_7 (Flatten)         (None, 62720)             0         \n","                                                                 \n"," dense_14 (Dense)            (None, 1024)              64226304  \n","                                                                 \n"," dropout_2 (Dropout)         (None, 1024)              0         \n","                                                                 \n"," dense_15 (Dense)            (None, 15)                15375     \n","                                                                 \n","=================================================================\n","Total params: 181,988,527\n","Trainable params: 181,475,951\n","Non-trainable params: 512,576\n","_________________________________________________________________\n"]}]},{"cell_type":"code","source":["conv_base.trainable = False"],"metadata":{"id":"yZLpBIv0vzKz"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["model.summary()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"COwxdXH7wil7","executionInfo":{"status":"ok","timestamp":1649934484164,"user_tz":-300,"elapsed":668,"user":{"displayName":"Даниил Маненок","userId":"11391168364756720378"}},"outputId":"473af330-3fc5-4c0c-c23e-a766ec66c299"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Model: \"sequential_7\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," efficientnetv2-l (Functiona  (None, 7, 7, 1280)       117746848 \n"," l)                                                              \n","                                                                 \n"," flatten_7 (Flatten)         (None, 62720)             0         \n","                                                                 \n"," dense_14 (Dense)            (None, 1024)              64226304  \n","                                                                 \n"," dropout_2 (Dropout)         (None, 1024)              0         \n","                                                                 \n"," dense_15 (Dense)            (None, 15)                15375     \n","                                                                 \n","=================================================================\n","Total params: 181,988,527\n","Trainable params: 64,241,679\n","Non-trainable params: 117,746,848\n","_________________________________________________________________\n"]}]},{"cell_type":"code","source":["model.compile(loss='categorical_crossentropy',\n","              optimizer=optimizers.RMSprop(learning_rate=1e-4),\n","              metrics=['acc'])"],"metadata":{"id":"j84d1WXjv4W1"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["history = model.fit(train_generator,\n","                    steps_per_epoch=train_stop,\n","                    epochs=20,\n","                    validation_data=validation_generator,\n","                    validation_steps=validation_stop)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"EZqhr87Sv_f7","outputId":"19d4b8c7-45dd-4c30-8b18-6b85579bc758"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/20\n","23/23 [==============================] - 497s 20s/step - loss: 1.9502 - acc: 0.5279 - val_loss: 1.0453 - val_acc: 0.6391\n","Epoch 2/20\n","23/23 [==============================] - 459s 20s/step - loss: 0.7809 - acc: 0.7272 - val_loss: 0.5504 - val_acc: 0.7859\n","Epoch 3/20\n","23/23 [==============================] - 455s 20s/step - loss: 0.6767 - acc: 0.7584 - val_loss: 0.4462 - val_acc: 0.8328\n","Epoch 4/20\n","23/23 [==============================] - 456s 20s/step - loss: 0.5722 - acc: 0.7942 - val_loss: 0.3888 - val_acc: 0.8422\n","Epoch 5/20\n","23/23 [==============================] - 434s 19s/step - loss: 0.5261 - acc: 0.8050 - val_loss: 0.3705 - val_acc: 0.8422\n","Epoch 6/20\n","10/23 [============>.................] - ETA: 3:06 - loss: 0.4971 - acc: 0.8125"]}]},{"cell_type":"code","source":[""],"metadata":{"id":"1zu4Cd-jwoHi"},"execution_count":null,"outputs":[]}],"metadata":{"accelerator":"GPU","colab":{"collapsed_sections":[],"name":"Копия блокнота \"CV_14042022.ipynb\"","provenance":[{"file_id":"1fLgUsuepg85zrjaJBv2xi8vIL443QY-E","timestamp":1650047845362}]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}